const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Comk0Mdd.js","assets/tmagic-dep-DGKTcpmx.js","assets/_plugin-vue_export-helper-aHMrgx-o.js","assets/use-component-DF1g8s6a.js","assets/Container-BpMiPnhd.js","assets/index-BMAuCMjm.js","assets/index-dqwW3_a1.js","assets/index-9nwqbliO.js","assets/index-T3SVGUQk.js","assets/index-BefqyKqa.js","assets/PageFragmentContainer-4IB1FBBb.js","assets/PageFragmentContainer-Db09S4Ne.css","assets/PageFragment-Ce_jqCIf.js","assets/IteratorContainer-BzvKmQpC.js"])))=>i.map(i=>d[i]);
var Z=Object.defineProperty;var J=e=>{throw TypeError(e)};var ee=(e,r,n)=>r in e?Z(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;var $=(e,r,n)=>ee(e,typeof r!="symbol"?r+"":r,n),Y=(e,r,n)=>r.has(e)||J("Cannot "+n);var L=(e,r,n)=>(Y(e,r,"read from private field"),n?n.call(e):r.get(e)),N=(e,r,n)=>r.has(e)?J("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,n),q=(e,r,n,s)=>(Y(e,r,"write to private field"),s?s.call(e,n):r.set(e,n),n);function __vite_legacy_guard(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var e=typeof Reflect=="object"?Reflect:null,r=e&&typeof e.apply=="function"?e.apply:function(m,T,_){return Function.prototype.apply.call(m,T,_)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:n=function(m){return Object.getOwnPropertyNames(m)};function s(p){console&&console.warn&&console.warn(p)}var i=Number.isNaN||function(m){return m!==m};function o(){o.init.call(this)}events.exports=o,events.exports.once=I,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function u(p){if(typeof p!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof p)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(p){if(typeof p!="number"||p<0||i(p))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+p+".");c=p}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||i(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this};function l(p){return p._maxListeners===void 0?o.defaultMaxListeners:p._maxListeners}o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(m){for(var T=[],_=1;_<arguments.length;_++)T.push(arguments[_]);var g=m==="error",A=this._events;if(A!==void 0)g=g&&A.error===void 0;else if(!g)return!1;if(g){var S;if(T.length>0&&(S=T[0]),S instanceof Error)throw S;var R=new Error("Unhandled error."+(S?" ("+S.message+")":""));throw R.context=S,R}var D=A[m];if(D===void 0)return!1;if(typeof D=="function")r(D,this,T);else for(var M=D.length,H=v(D,M),_=0;_<M;++_)r(H[_],this,T);return!0};function f(p,m,T,_){var g,A,S;if(u(T),A=p._events,A===void 0?(A=p._events=Object.create(null),p._eventsCount=0):(A.newListener!==void 0&&(p.emit("newListener",m,T.listener?T.listener:T),A=p._events),S=A[m]),S===void 0)S=A[m]=T,++p._eventsCount;else if(typeof S=="function"?S=A[m]=_?[T,S]:[S,T]:_?S.unshift(T):S.push(T),g=l(p),g>0&&S.length>g&&!S.warned){S.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+S.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");R.name="MaxListenersExceededWarning",R.emitter=p,R.type=m,R.count=S.length,s(R)}return p}o.prototype.addListener=function(m,T){return f(this,m,T,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(m,T){return f(this,m,T,!0)};function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(p,m,T){var _={fired:!1,wrapFn:void 0,target:p,type:m,listener:T},g=d.bind(_);return g.listener=T,_.wrapFn=g,g}o.prototype.once=function(m,T){return u(T),this.on(m,h(this,m,T)),this},o.prototype.prependOnceListener=function(m,T){return u(T),this.prependListener(m,h(this,m,T)),this},o.prototype.removeListener=function(m,T){var _,g,A,S,R;if(u(T),g=this._events,g===void 0)return this;if(_=g[m],_===void 0)return this;if(_===T||_.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete g[m],g.removeListener&&this.emit("removeListener",m,_.listener||T));else if(typeof _!="function"){for(A=-1,S=_.length-1;S>=0;S--)if(_[S]===T||_[S].listener===T){R=_[S].listener,A=S;break}if(A<0)return this;A===0?_.shift():j(_,A),_.length===1&&(g[m]=_[0]),g.removeListener!==void 0&&this.emit("removeListener",m,R||T)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(m){var T,_,g;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[m]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[m]),this;if(arguments.length===0){var A=Object.keys(_),S;for(g=0;g<A.length;++g)S=A[g],S!=="removeListener"&&this.removeAllListeners(S);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=_[m],typeof T=="function")this.removeListener(m,T);else if(T!==void 0)for(g=T.length-1;g>=0;g--)this.removeListener(m,T[g]);return this};function y(p,m,T){var _=p._events;if(_===void 0)return[];var g=_[m];return g===void 0?[]:typeof g=="function"?T?[g.listener||g]:[g]:T?w(g):v(g,g.length)}o.prototype.listeners=function(m){return y(this,m,!0)},o.prototype.rawListeners=function(m){return y(this,m,!1)},o.listenerCount=function(p,m){return typeof p.listenerCount=="function"?p.listenerCount(m):b.call(p,m)},o.prototype.listenerCount=b;function b(p){var m=this._events;if(m!==void 0){var T=m[p];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function v(p,m){for(var T=new Array(m),_=0;_<m;++_)T[_]=p[_];return T}function j(p,m){for(;m+1<p.length;m++)p[m]=p[m+1];p.pop()}function w(p){for(var m=new Array(p.length),T=0;T<m.length;++T)m[T]=p[T].listener||p[T];return m}function I(p,m){return new Promise(function(T,_){function g(S){p.removeListener(m,A),_(S)}function A(){typeof p.removeListener=="function"&&p.removeListener("error",g),T([].slice.call(arguments))}x(p,m,A,{once:!0}),m!=="error"&&P(p,g,{once:!0})})}function P(p,m,T){typeof p.on=="function"&&x(p,"error",m,T)}function x(p,m,T,_){if(typeof p.on=="function")_.once?p.once(m,T):p.on(m,T);else if(typeof p.addEventListener=="function")p.addEventListener(m,function g(A){_.once&&p.removeEventListener(m,g),T(A)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof p)}return events.exports}var eventsExports=requireEvents();const EventEmitter$1=getDefaultExportFromCjs(eventsExports);var freeGlobal$1=typeof global=="object"&&global&&global.Object===Object&&global,freeSelf$1=typeof self=="object"&&self&&self.Object===Object&&self,root$1=freeGlobal$1||freeSelf$1||Function("return this")(),Symbol$2=root$1.Symbol,objectProto$q=Object.prototype,hasOwnProperty$k=objectProto$q.hasOwnProperty,nativeObjectToString$3=objectProto$q.toString,symToStringTag$3=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag$1(e){var r=hasOwnProperty$k.call(e,symToStringTag$3),n=e[symToStringTag$3];try{e[symToStringTag$3]=void 0;var s=!0}catch(o){}var i=nativeObjectToString$3.call(e);return s&&(r?e[symToStringTag$3]=n:delete e[symToStringTag$3]),i}var objectProto$p=Object.prototype,nativeObjectToString$2=objectProto$p.toString;function objectToString$1(e){return nativeObjectToString$2.call(e)}var nullTag$1="[object Null]",undefinedTag$1="[object Undefined]",symToStringTag$2=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag$1(e){return e==null?e===void 0?undefinedTag$1:nullTag$1:symToStringTag$2&&symToStringTag$2 in Object(e)?getRawTag$1(e):objectToString$1(e)}function isObjectLike$1(e){return e!=null&&typeof e=="object"}var symbolTag$4="[object Symbol]";function isSymbol(e){return typeof e=="symbol"||isObjectLike$1(e)&&baseGetTag$1(e)==symbolTag$4}function arrayMap(e,r){for(var n=-1,s=e==null?0:e.length,i=Array(s);++n<s;)i[n]=r(e[n],n,e);return i}var isArray$1=Array.isArray,INFINITY$2=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(e){if(typeof e=="string")return e;if(isArray$1(e))return arrayMap(e,baseToString)+"";if(isSymbol(e))return symbolToString?symbolToString.call(e):"";var r=e+"";return r=="0"&&1/e==-INFINITY$2?"-0":r}function isObject$3(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var asyncTag$1="[object AsyncFunction]",funcTag$5="[object Function]",genTag$3="[object GeneratorFunction]",proxyTag$1="[object Proxy]";function isFunction$1(e){if(!isObject$3(e))return!1;var r=baseGetTag$1(e);return r==funcTag$5||r==genTag$3||r==asyncTag$1||r==proxyTag$1}var coreJsData$1=root$1["__core-js_shared__"],maskSrcKey$1=function(){var e=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked$1(e){return!!maskSrcKey$1&&maskSrcKey$1 in e}var funcProto$3=Function.prototype,funcToString$3=funcProto$3.toString;function toSource$1(e){if(e!=null){try{return funcToString$3.call(e)}catch(r){}try{return e+""}catch(r){}}return""}var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor$1=/^\[object .+?Constructor\]$/,funcProto$2=Function.prototype,objectProto$o=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$j=objectProto$o.hasOwnProperty,reIsNative$1=RegExp("^"+funcToString$2.call(hasOwnProperty$j).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$1(e){if(!isObject$3(e)||isMasked$1(e))return!1;var r=isFunction$1(e)?reIsNative$1:reIsHostCtor$1;return r.test(toSource$1(e))}function getValue$1(e,r){return e==null?void 0:e[r]}function getNative$1(e,r){var n=getValue$1(e,r);return baseIsNative$1(n)?n:void 0}var WeakMap$2=getNative$1(root$1,"WeakMap"),objectCreate$1=Object.create,baseCreate$1=function(){function e(){}return function(r){if(!isObject$3(r))return{};if(objectCreate$1)return objectCreate$1(r);e.prototype=r;var n=new e;return e.prototype=void 0,n}}();function copyArray(e,r){var n=-1,s=e.length;for(r||(r=Array(s));++n<s;)r[n]=e[n];return r}var defineProperty$1=function(){try{var e=getNative$1(Object,"defineProperty");return e({},"",{}),e}catch(r){}}();function arrayEach$1(e,r){for(var n=-1,s=e==null?0:e.length;++n<s&&r(e[n],n,e)!==!1;);return e}var MAX_SAFE_INTEGER$3=9007199254740991,reIsUint$1=/^(?:0|[1-9]\d*)$/;function isIndex$1(e,r){var n=typeof e;return r=r==null?MAX_SAFE_INTEGER$3:r,!!r&&(n=="number"||n!="symbol"&&reIsUint$1.test(e))&&e>-1&&e%1==0&&e<r}function baseAssignValue$1(e,r,n){r=="__proto__"&&defineProperty$1?defineProperty$1(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}function eq$1(e,r){return e===r||e!==e&&r!==r}var objectProto$n=Object.prototype,hasOwnProperty$i=objectProto$n.hasOwnProperty;function assignValue$1(e,r,n){var s=e[r];(!(hasOwnProperty$i.call(e,r)&&eq$1(s,n))||n===void 0&&!(r in e))&&baseAssignValue$1(e,r,n)}function copyObject(e,r,n,s){var i=!n;n||(n={});for(var o=-1,c=r.length;++o<c;){var u=r[o],l=void 0;l===void 0&&(l=e[u]),i?baseAssignValue$1(n,u,l):assignValue$1(n,u,l)}return n}var MAX_SAFE_INTEGER$2=9007199254740991;function isLength$1(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$2}function isArrayLike$1(e){return e!=null&&isLength$1(e.length)&&!isFunction$1(e)}var objectProto$m=Object.prototype;function isPrototype$1(e){var r=e&&e.constructor,n=typeof r=="function"&&r.prototype||objectProto$m;return e===n}function baseTimes$1(e,r){for(var n=-1,s=Array(e);++n<e;)s[n]=r(n);return s}var argsTag$5="[object Arguments]";function baseIsArguments$1(e){return isObjectLike$1(e)&&baseGetTag$1(e)==argsTag$5}var objectProto$l=Object.prototype,hasOwnProperty$h=objectProto$l.hasOwnProperty,propertyIsEnumerable$3=objectProto$l.propertyIsEnumerable,isArguments$1=baseIsArguments$1(function(){return arguments}())?baseIsArguments$1:function(e){return isObjectLike$1(e)&&hasOwnProperty$h.call(e,"callee")&&!propertyIsEnumerable$3.call(e,"callee")};function stubFalse$1(){return!1}var freeExports$5=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$5=freeExports$5&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$5=freeModule$5&&freeModule$5.exports===freeExports$5,Buffer$3=moduleExports$5?root$1.Buffer:void 0,nativeIsBuffer$1=Buffer$3?Buffer$3.isBuffer:void 0,isBuffer$1=nativeIsBuffer$1||stubFalse$1,argsTag$4="[object Arguments]",arrayTag$3="[object Array]",boolTag$5="[object Boolean]",dateTag$5="[object Date]",errorTag$3="[object Error]",funcTag$4="[object Function]",mapTag$a="[object Map]",numberTag$5="[object Number]",objectTag$5="[object Object]",regexpTag$5="[object RegExp]",setTag$a="[object Set]",stringTag$5="[object String]",weakMapTag$5="[object WeakMap]",arrayBufferTag$5="[object ArrayBuffer]",dataViewTag$7="[object DataView]",float32Tag$5="[object Float32Array]",float64Tag$5="[object Float64Array]",int8Tag$5="[object Int8Array]",int16Tag$5="[object Int16Array]",int32Tag$5="[object Int32Array]",uint8Tag$5="[object Uint8Array]",uint8ClampedTag$5="[object Uint8ClampedArray]",uint16Tag$5="[object Uint16Array]",uint32Tag$5="[object Uint32Array]",typedArrayTags$1={};typedArrayTags$1[float32Tag$5]=typedArrayTags$1[float64Tag$5]=typedArrayTags$1[int8Tag$5]=typedArrayTags$1[int16Tag$5]=typedArrayTags$1[int32Tag$5]=typedArrayTags$1[uint8Tag$5]=typedArrayTags$1[uint8ClampedTag$5]=typedArrayTags$1[uint16Tag$5]=typedArrayTags$1[uint32Tag$5]=!0;typedArrayTags$1[argsTag$4]=typedArrayTags$1[arrayTag$3]=typedArrayTags$1[arrayBufferTag$5]=typedArrayTags$1[boolTag$5]=typedArrayTags$1[dataViewTag$7]=typedArrayTags$1[dateTag$5]=typedArrayTags$1[errorTag$3]=typedArrayTags$1[funcTag$4]=typedArrayTags$1[mapTag$a]=typedArrayTags$1[numberTag$5]=typedArrayTags$1[objectTag$5]=typedArrayTags$1[regexpTag$5]=typedArrayTags$1[setTag$a]=typedArrayTags$1[stringTag$5]=typedArrayTags$1[weakMapTag$5]=!1;function baseIsTypedArray$1(e){return isObjectLike$1(e)&&isLength$1(e.length)&&!!typedArrayTags$1[baseGetTag$1(e)]}function baseUnary$1(e){return function(r){return e(r)}}var freeExports$4=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$4=freeExports$4&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$4=freeModule$4&&freeModule$4.exports===freeExports$4,freeProcess$1=moduleExports$4&&freeGlobal$1.process,nodeUtil$1=function(){try{var e=freeModule$4&&freeModule$4.require&&freeModule$4.require("util").types;return e||freeProcess$1&&freeProcess$1.binding&&freeProcess$1.binding("util")}catch(r){}}(),nodeIsTypedArray$1=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray$1?baseUnary$1(nodeIsTypedArray$1):baseIsTypedArray$1,objectProto$k=Object.prototype,hasOwnProperty$g=objectProto$k.hasOwnProperty;function arrayLikeKeys$1(e,r){var n=isArray$1(e),s=!n&&isArguments$1(e),i=!n&&!s&&isBuffer$1(e),o=!n&&!s&&!i&&isTypedArray$1(e),c=n||s||i||o,u=c?baseTimes$1(e.length,String):[],l=u.length;for(var f in e)(r||hasOwnProperty$g.call(e,f))&&!(c&&(f=="length"||i&&(f=="offset"||f=="parent")||o&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||isIndex$1(f,l)))&&u.push(f);return u}function overArg$1(e,r){return function(n){return e(r(n))}}var nativeKeys$1=overArg$1(Object.keys,Object),objectProto$j=Object.prototype,hasOwnProperty$f=objectProto$j.hasOwnProperty;function baseKeys$1(e){if(!isPrototype$1(e))return nativeKeys$1(e);var r=[];for(var n in Object(e))hasOwnProperty$f.call(e,n)&&n!="constructor"&&r.push(n);return r}function keys$1(e){return isArrayLike$1(e)?arrayLikeKeys$1(e):baseKeys$1(e)}function nativeKeysIn(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}var objectProto$i=Object.prototype,hasOwnProperty$e=objectProto$i.hasOwnProperty;function baseKeysIn(e){if(!isObject$3(e))return nativeKeysIn(e);var r=isPrototype$1(e),n=[];for(var s in e)s=="constructor"&&(r||!hasOwnProperty$e.call(e,s))||n.push(s);return n}function keysIn(e){return isArrayLike$1(e)?arrayLikeKeys$1(e,!0):baseKeysIn(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,r){if(isArray$1(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||isSymbol(e)?!0:reIsPlainProp.test(e)||!reIsDeepProp.test(e)||r!=null&&e in Object(r)}var nativeCreate$1=getNative$1(Object,"create");function hashClear$1(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete$1(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var HASH_UNDEFINED$4="__lodash_hash_undefined__",objectProto$h=Object.prototype,hasOwnProperty$d=objectProto$h.hasOwnProperty;function hashGet$1(e){var r=this.__data__;if(nativeCreate$1){var n=r[e];return n===HASH_UNDEFINED$4?void 0:n}return hasOwnProperty$d.call(r,e)?r[e]:void 0}var objectProto$g=Object.prototype,hasOwnProperty$c=objectProto$g.hasOwnProperty;function hashHas$1(e){var r=this.__data__;return nativeCreate$1?r[e]!==void 0:hasOwnProperty$c.call(r,e)}var HASH_UNDEFINED$3="__lodash_hash_undefined__";function hashSet$1(e,r){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nativeCreate$1&&r===void 0?HASH_UNDEFINED$3:r,this}function Hash$1(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}Hash$1.prototype.clear=hashClear$1;Hash$1.prototype.delete=hashDelete$1;Hash$1.prototype.get=hashGet$1;Hash$1.prototype.has=hashHas$1;Hash$1.prototype.set=hashSet$1;function listCacheClear$1(){this.__data__=[],this.size=0}function assocIndexOf$1(e,r){for(var n=e.length;n--;)if(eq$1(e[n][0],r))return n;return-1}var arrayProto$1=Array.prototype,splice$1=arrayProto$1.splice;function listCacheDelete$1(e){var r=this.__data__,n=assocIndexOf$1(r,e);if(n<0)return!1;var s=r.length-1;return n==s?r.pop():splice$1.call(r,n,1),--this.size,!0}function listCacheGet$1(e){var r=this.__data__,n=assocIndexOf$1(r,e);return n<0?void 0:r[n][1]}function listCacheHas$1(e){return assocIndexOf$1(this.__data__,e)>-1}function listCacheSet$1(e,r){var n=this.__data__,s=assocIndexOf$1(n,e);return s<0?(++this.size,n.push([e,r])):n[s][1]=r,this}function ListCache$1(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}ListCache$1.prototype.clear=listCacheClear$1;ListCache$1.prototype.delete=listCacheDelete$1;ListCache$1.prototype.get=listCacheGet$1;ListCache$1.prototype.has=listCacheHas$1;ListCache$1.prototype.set=listCacheSet$1;var Map$2=getNative$1(root$1,"Map");function mapCacheClear$1(){this.size=0,this.__data__={hash:new Hash$1,map:new(Map$2||ListCache$1),string:new Hash$1}}function isKeyable$1(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function getMapData$1(e,r){var n=e.__data__;return isKeyable$1(r)?n[typeof r=="string"?"string":"hash"]:n.map}function mapCacheDelete$1(e){var r=getMapData$1(this,e).delete(e);return this.size-=r?1:0,r}function mapCacheGet$1(e){return getMapData$1(this,e).get(e)}function mapCacheHas$1(e){return getMapData$1(this,e).has(e)}function mapCacheSet$1(e,r){var n=getMapData$1(this,e),s=n.size;return n.set(e,r),this.size+=n.size==s?0:1,this}function MapCache$1(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}MapCache$1.prototype.clear=mapCacheClear$1;MapCache$1.prototype.delete=mapCacheDelete$1;MapCache$1.prototype.get=mapCacheGet$1;MapCache$1.prototype.has=mapCacheHas$1;MapCache$1.prototype.set=mapCacheSet$1;var FUNC_ERROR_TEXT="Expected a function";function memoize(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(FUNC_ERROR_TEXT);var n=function(){var s=arguments,i=r?r.apply(this,s):s[0],o=n.cache;if(o.has(i))return o.get(i);var c=e.apply(this,s);return n.cache=o.set(i,c)||o,c};return n.cache=new(memoize.Cache||MapCache$1),n}memoize.Cache=MapCache$1;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var r=memoize(e,function(s){return n.size===MAX_MEMOIZE_SIZE&&n.clear(),s}),n=r.cache;return r}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(rePropName,function(n,s,i,o){r.push(i?o.replace(reEscapeChar,"$1"):s||n)}),r});function toString(e){return e==null?"":baseToString(e)}function castPath(e,r){return isArray$1(e)?e:isKey(e,r)?[e]:stringToPath(toString(e))}var INFINITY$1=1/0;function toKey(e){if(typeof e=="string"||isSymbol(e))return e;var r=e+"";return r=="0"&&1/e==-INFINITY$1?"-0":r}function arrayPush$1(e,r){for(var n=-1,s=r.length,i=e.length;++n<s;)e[i+n]=r[n];return e}var getPrototype$1=overArg$1(Object.getPrototypeOf,Object);function stackClear$1(){this.__data__=new ListCache$1,this.size=0}function stackDelete$1(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}function stackGet$1(e){return this.__data__.get(e)}function stackHas$1(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE$2=200;function stackSet$1(e,r){var n=this.__data__;if(n instanceof ListCache$1){var s=n.__data__;if(!Map$2||s.length<LARGE_ARRAY_SIZE$2-1)return s.push([e,r]),this.size=++n.size,this;n=this.__data__=new MapCache$1(s)}return n.set(e,r),this.size=n.size,this}function Stack$1(e){var r=this.__data__=new ListCache$1(e);this.size=r.size}Stack$1.prototype.clear=stackClear$1;Stack$1.prototype.delete=stackDelete$1;Stack$1.prototype.get=stackGet$1;Stack$1.prototype.has=stackHas$1;Stack$1.prototype.set=stackSet$1;function baseAssign(e,r){return e&&copyObject(r,keys$1(r),e)}function baseAssignIn(e,r){return e&&copyObject(r,keysIn(r),e)}var freeExports$3=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$3=freeExports$3&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$3=freeModule$3&&freeModule$3.exports===freeExports$3,Buffer$2=moduleExports$3?root$1.Buffer:void 0,allocUnsafe=Buffer$2?Buffer$2.allocUnsafe:void 0;function cloneBuffer$1(e,r){if(r)return e.slice();var n=e.length,s=allocUnsafe?allocUnsafe(n):new e.constructor(n);return e.copy(s),s}function arrayFilter$1(e,r){for(var n=-1,s=e==null?0:e.length,i=0,o=[];++n<s;){var c=e[n];r(c,n,e)&&(o[i++]=c)}return o}function stubArray$1(){return[]}var objectProto$f=Object.prototype,propertyIsEnumerable$2=objectProto$f.propertyIsEnumerable,nativeGetSymbols$2=Object.getOwnPropertySymbols,getSymbols$1=nativeGetSymbols$2?function(e){return e==null?[]:(e=Object(e),arrayFilter$1(nativeGetSymbols$2(e),function(r){return propertyIsEnumerable$2.call(e,r)}))}:stubArray$1;function copySymbols(e,r){return copyObject(e,getSymbols$1(e),r)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(e){for(var r=[];e;)arrayPush$1(r,getSymbols$1(e)),e=getPrototype$1(e);return r}:stubArray$1;function copySymbolsIn(e,r){return copyObject(e,getSymbolsIn(e),r)}function baseGetAllKeys$1(e,r,n){var s=r(e);return isArray$1(e)?s:arrayPush$1(s,n(e))}function getAllKeys$1(e){return baseGetAllKeys$1(e,keys$1,getSymbols$1)}function getAllKeysIn(e){return baseGetAllKeys$1(e,keysIn,getSymbolsIn)}var DataView$1=getNative$1(root$1,"DataView"),Promise$2=getNative$1(root$1,"Promise"),Set$2=getNative$1(root$1,"Set"),mapTag$9="[object Map]",objectTag$4="[object Object]",promiseTag$1="[object Promise]",setTag$9="[object Set]",weakMapTag$4="[object WeakMap]",dataViewTag$6="[object DataView]",dataViewCtorString$1=toSource$1(DataView$1),mapCtorString$1=toSource$1(Map$2),promiseCtorString$1=toSource$1(Promise$2),setCtorString$1=toSource$1(Set$2),weakMapCtorString$1=toSource$1(WeakMap$2),getTag$1=baseGetTag$1;(DataView$1&&getTag$1(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$6||Map$2&&getTag$1(new Map$2)!=mapTag$9||Promise$2&&getTag$1(Promise$2.resolve())!=promiseTag$1||Set$2&&getTag$1(new Set$2)!=setTag$9||WeakMap$2&&getTag$1(new WeakMap$2)!=weakMapTag$4)&&(getTag$1=function(e){var r=baseGetTag$1(e),n=r==objectTag$4?e.constructor:void 0,s=n?toSource$1(n):"";if(s)switch(s){case dataViewCtorString$1:return dataViewTag$6;case mapCtorString$1:return mapTag$9;case promiseCtorString$1:return promiseTag$1;case setCtorString$1:return setTag$9;case weakMapCtorString$1:return weakMapTag$4}return r});var objectProto$e=Object.prototype,hasOwnProperty$b=objectProto$e.hasOwnProperty;function initCloneArray$1(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&hasOwnProperty$b.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var Uint8Array$2=root$1.Uint8Array;function cloneArrayBuffer$1(e){var r=new e.constructor(e.byteLength);return new Uint8Array$2(r).set(new Uint8Array$2(e)),r}function cloneDataView$1(e,r){var n=r?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var reFlags$1=/\w*$/;function cloneRegExp$1(e){var r=new e.constructor(e.source,reFlags$1.exec(e));return r.lastIndex=e.lastIndex,r}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol$1(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}function cloneTypedArray$1(e,r){var n=r?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var boolTag$4="[object Boolean]",dateTag$4="[object Date]",mapTag$8="[object Map]",numberTag$4="[object Number]",regexpTag$4="[object RegExp]",setTag$8="[object Set]",stringTag$4="[object String]",symbolTag$3="[object Symbol]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$5="[object DataView]",float32Tag$4="[object Float32Array]",float64Tag$4="[object Float64Array]",int8Tag$4="[object Int8Array]",int16Tag$4="[object Int16Array]",int32Tag$4="[object Int32Array]",uint8Tag$4="[object Uint8Array]",uint8ClampedTag$4="[object Uint8ClampedArray]",uint16Tag$4="[object Uint16Array]",uint32Tag$4="[object Uint32Array]";function initCloneByTag$1(e,r,n){var s=e.constructor;switch(r){case arrayBufferTag$4:return cloneArrayBuffer$1(e);case boolTag$4:case dateTag$4:return new s(+e);case dataViewTag$5:return cloneDataView$1(e,n);case float32Tag$4:case float64Tag$4:case int8Tag$4:case int16Tag$4:case int32Tag$4:case uint8Tag$4:case uint8ClampedTag$4:case uint16Tag$4:case uint32Tag$4:return cloneTypedArray$1(e,n);case mapTag$8:return new s;case numberTag$4:case stringTag$4:return new s(e);case regexpTag$4:return cloneRegExp$1(e);case setTag$8:return new s;case symbolTag$3:return cloneSymbol$1(e)}}function initCloneObject$1(e){return typeof e.constructor=="function"&&!isPrototype$1(e)?baseCreate$1(getPrototype$1(e)):{}}var mapTag$7="[object Map]";function baseIsMap$1(e){return isObjectLike$1(e)&&getTag$1(e)==mapTag$7}var nodeIsMap$1=nodeUtil$1&&nodeUtil$1.isMap,isMap$1=nodeIsMap$1?baseUnary$1(nodeIsMap$1):baseIsMap$1,setTag$7="[object Set]";function baseIsSet$1(e){return isObjectLike$1(e)&&getTag$1(e)==setTag$7}var nodeIsSet$1=nodeUtil$1&&nodeUtil$1.isSet,isSet$1=nodeIsSet$1?baseUnary$1(nodeIsSet$1):baseIsSet$1,CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$3="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$3="[object Function]",genTag$2="[object GeneratorFunction]",mapTag$6="[object Map]",numberTag$3="[object Number]",objectTag$3="[object Object]",regexpTag$3="[object RegExp]",setTag$6="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",weakMapTag$3="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$3="[object Float32Array]",float64Tag$3="[object Float64Array]",int8Tag$3="[object Int8Array]",int16Tag$3="[object Int16Array]",int32Tag$3="[object Int32Array]",uint8Tag$3="[object Uint8Array]",uint8ClampedTag$3="[object Uint8ClampedArray]",uint16Tag$3="[object Uint16Array]",uint32Tag$3="[object Uint32Array]",cloneableTags$1={};cloneableTags$1[argsTag$3]=cloneableTags$1[arrayTag$2]=cloneableTags$1[arrayBufferTag$3]=cloneableTags$1[dataViewTag$4]=cloneableTags$1[boolTag$3]=cloneableTags$1[dateTag$3]=cloneableTags$1[float32Tag$3]=cloneableTags$1[float64Tag$3]=cloneableTags$1[int8Tag$3]=cloneableTags$1[int16Tag$3]=cloneableTags$1[int32Tag$3]=cloneableTags$1[mapTag$6]=cloneableTags$1[numberTag$3]=cloneableTags$1[objectTag$3]=cloneableTags$1[regexpTag$3]=cloneableTags$1[setTag$6]=cloneableTags$1[stringTag$3]=cloneableTags$1[symbolTag$2]=cloneableTags$1[uint8Tag$3]=cloneableTags$1[uint8ClampedTag$3]=cloneableTags$1[uint16Tag$3]=cloneableTags$1[uint32Tag$3]=!0;cloneableTags$1[errorTag$2]=cloneableTags$1[funcTag$3]=cloneableTags$1[weakMapTag$3]=!1;function baseClone$1(e,r,n,s,i,o){var c,u=r&CLONE_DEEP_FLAG$2,l=r&CLONE_FLAT_FLAG,f=r&CLONE_SYMBOLS_FLAG$2;if(c!==void 0)return c;if(!isObject$3(e))return e;var d=isArray$1(e);if(d){if(c=initCloneArray$1(e),!u)return copyArray(e,c)}else{var h=getTag$1(e),y=h==funcTag$3||h==genTag$2;if(isBuffer$1(e))return cloneBuffer$1(e,u);if(h==objectTag$3||h==argsTag$3||y&&!i){if(c=l||y?{}:initCloneObject$1(e),!u)return l?copySymbolsIn(e,baseAssignIn(c,e)):copySymbols(e,baseAssign(c,e))}else{if(!cloneableTags$1[h])return i?e:{};c=initCloneByTag$1(e,h,u)}}o||(o=new Stack$1);var b=o.get(e);if(b)return b;o.set(e,c),isSet$1(e)?e.forEach(function(w){c.add(baseClone$1(w,r,n,w,e,o))}):isMap$1(e)&&e.forEach(function(w,I){c.set(I,baseClone$1(w,r,n,I,e,o))});var v=f?l?getAllKeysIn:getAllKeys$1:l?keysIn:keys$1,j=d?void 0:v(e);return arrayEach$1(j||e,function(w,I){j&&(I=w,w=e[I]),assignValue$1(c,I,baseClone$1(w,r,n,I,e,o))}),c}var CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep$1(e){return baseClone$1(e,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$1)}function hasPath(e,r,n){r=castPath(r,e);for(var s=-1,i=r.length,o=!1;++s<i;){var c=toKey(r[s]);if(!(o=e!=null&&n(e,c)))break;e=e[c]}return o||++s!=i?o:(i=e==null?0:e.length,!!i&&isLength$1(i)&&isIndex$1(c,i)&&(isArray$1(e)||isArguments$1(e)))}var objectProto$d=Object.prototype,hasOwnProperty$a=objectProto$d.hasOwnProperty;function baseHas(e,r){return e!=null&&hasOwnProperty$a.call(e,r)}function has(e,r){return e!=null&&hasPath(e,r,baseHas)}var mapTag$5="[object Map]",setTag$5="[object Set]",objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function isEmpty(e){if(e==null)return!0;if(isArrayLike$1(e)&&(isArray$1(e)||typeof e=="string"||typeof e.splice=="function"||isBuffer$1(e)||isTypedArray$1(e)||isArguments$1(e)))return!e.length;var r=getTag$1(e);if(r==mapTag$5||r==setTag$5)return!e.size;if(isPrototype$1(e))return!baseKeys$1(e).length;for(var n in e)if(hasOwnProperty$3.call(e,n))return!1;return!0}function baseSet(e,r,n,s){if(!isObject$3(e))return e;r=castPath(r,e);for(var i=-1,o=r.length,c=o-1,u=e;u!=null&&++i<o;){var l=toKey(r[i]),f=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(i!=c){var d=u[l];f=void 0,f===void 0&&(f=isObject$3(d)?d:isIndex$1(r[i+1])?[]:{})}assignValue$1(u,l,f),u=u[l]}return e}function set(e,r,n){return e==null?e:baseSet(e,r,n)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function __awaiter(e,r,n,s){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(d){try{f(s.next(d))}catch(h){c(h)}}function l(d){try{f(s.throw(d))}catch(h){c(h)}}function f(d){d.done?o(d.value):i(d.value).then(u,l)}f((s=s.apply(e,[])).next())})}const segments=[];function Match(e,r,n="*"){if(e===n)return!0;segments.length=0;let s=0,i=0,o=0,c=0;for(let y=0,b=e.length;y<b;y+=1){const v=e[y];v===n&&(s+=1,y>c&&segments.push(e.substring(c,y)),segments.push(v),c=y+1)}if(c<e.length&&segments.push(e.substring(c)),s?(i=e.length-s,o=1/0):o=i=e.length,segments.length===0)return e===r;const u=r.length;if(u<i||u>o)return!1;let l=0,f=segments.length-1,d=r.length-1,h=!1;for(;;){const y=segments[f];if(f-=1,y===n)h=!0;else{const b=d+1-y.length,v=r.lastIndexOf(y,b);if(v===-1||v>b)return!1;if(h)d=v-1,h=!1;else{if(v!==b)return!1;d-=y.length}}if(l>f)break}return!0}class WildcardObject{constructor(r,n,s,i=void 0){this.obj=r,this.delimiter=n,this.wildcard=s,this.is_match=i}shortMatch(r,n){if(r===n||r===this.wildcard)return!0;if(this.is_match)return this.is_match(r,n);const s=r.indexOf(this.wildcard);if(s>-1){const i=r.substr(s+1);if(s===0||n.substring(0,s)===r.substring(0,s)){const o=i.length;return o>0?n.substr(-o)===i:!0}}return!1}match(r,n){return this.is_match?this.is_match(r,n):r===n||r===this.wildcard||n===this.wildcard||this.shortMatch(r,n)||Match(r,n,this.wildcard)}handleArray(r,n,s,i,o={}){let c=r.indexOf(this.delimiter,s),u=!1;c===-1&&(u=!0,c=r.length);const l=r.substring(s,c);let f=0;for(const d of n){const h=f.toString(),y=i===""?h:i+this.delimiter+f;(l===this.wildcard||l===h||this.shortMatch(l,h))&&(u?o[y]=d:this.goFurther(r,d,c+1,y,o)),f++}return o}handleObject(r,n,s,i,o={}){let c=r.indexOf(this.delimiter,s),u=!1;c===-1&&(u=!0,c=r.length);const l=r.substring(s,c);for(let f in n){f=f.toString();const d=i===""?f:i+this.delimiter+f;(l===this.wildcard||l===f||this.shortMatch(l,f))&&(u?o[d]=n[f]:this.goFurther(r,n[f],c+1,d,o))}return o}goFurther(r,n,s,i,o={}){return Array.isArray(n)?this.handleArray(r,n,s,i,o):this.handleObject(r,n,s,i,o)}get(r){return this.goFurther(r,this.obj,0,"")}}class ObjectPath{static get(r,n,s=!1){if(!n)return;let i=n;for(const o of r)if(o in i)i=i[o];else if(s)i[o]=Object.create({}),i=i[o];else return;return i}static set(r,n,s){if(!s)return;if(r.length===0){for(const u in s)delete s[u];for(const u in n)s[u]=n[u];return}const i=r.slice(),o=i.pop(),c=ObjectPath.get(i,s,!0);return typeof c=="object"&&(c[o]=n),n}}let wasm,WASM_VECTOR_LEN=0,cachegetUint8Memory0=null;function getUint8Memory0(){return(cachegetUint8Memory0===null||cachegetUint8Memory0.buffer!==wasm.memory.buffer)&&(cachegetUint8Memory0=new Uint8Array(wasm.memory.buffer)),cachegetUint8Memory0}let cachedTextEncoder=new TextEncoder("utf-8");const encodeString=typeof cachedTextEncoder.encodeInto=="function"?function(e,r){return cachedTextEncoder.encodeInto(e,r)}:function(e,r){const n=cachedTextEncoder.encode(e);return r.set(n),{read:e.length,written:n.length}};function passStringToWasm0(e,r,n){if(n===void 0){const u=cachedTextEncoder.encode(e),l=r(u.length);return getUint8Memory0().subarray(l,l+u.length).set(u),WASM_VECTOR_LEN=u.length,l}let s=e.length,i=r(s);const o=getUint8Memory0();let c=0;for(;c<s;c++){const u=e.charCodeAt(c);if(u>127)break;o[i+c]=u}if(c!==s){c!==0&&(e=e.slice(c)),i=n(i,s,s=c+e.length*3);const u=getUint8Memory0().subarray(i+c,i+s),l=encodeString(e,u);c+=l.written}return WASM_VECTOR_LEN=c,i}function is_match(e,r){var n=passStringToWasm0(e,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),s=WASM_VECTOR_LEN,i=passStringToWasm0(r,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),o=WASM_VECTOR_LEN,c=wasm.is_match(n,s,i,o);return c!==0}async function load(e,r){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,r)}catch(s){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s);else throw s}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,r)}else{const n=await WebAssembly.instantiate(e,r);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}async function init(e){const r={};(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:s}=await load(await e,r);return wasm=n.exports,init.__wbindgen_wasm_module=s,wasm}const defaultUpdateOptions={only:[],source:"",debug:!1,data:void 0,queue:!1,force:!1};function log(e,r){console.debug(e,r)}function getDefaultOptions(){return{delimiter:".",debug:!1,extraDebug:!1,useMute:!0,notRecursive:";",param:":",wildcard:"*",experimentalMatch:!1,queue:!1,defaultBulkValue:!0,useCache:!1,useSplitCache:!1,useIndicesCache:!1,maxSimultaneousJobs:1e3,maxQueueRuns:1e3,log,Promise}}function isObject$2(e){return e&&e.constructor?e.constructor.name==="Object":typeof e=="object"&&e!==null}class DeepState{constructor(r={},n={}){this.jobsRunning=0,this.updateQueue=[],this.subscribeQueue=[],this.listenersIgnoreCache=new WeakMap,this.is_match=null,this.destroyed=!1,this.queueRuns=0,this.groupId=0,this.namedGroups=[],this.numberGroups=[],this.traceId=0,this.traceMap=new Map,this.tracing=[],this.savedTrace=[],this.collection=null,this.collections=0,this.cache=new Map,this.splitCache=new Map,this.indices=new Map,this.indicesCount=new Map,this.lastExecs=new WeakMap,this.listeners=new Map,this.waitingListeners=new Map,this.options=Object.assign(Object.assign({},getDefaultOptions()),n),this.data=r,this.id=0,this.options.useCache?(this.pathGet=this.cacheGet,this.pathSet=this.cacheSet):(this.pathGet=ObjectPath.get,this.pathSet=ObjectPath.set),n.Promise?this.resolved=n.Promise.resolve():this.resolved=Promise.resolve(),this.muted=new Set,this.mutedListeners=new Set,this.scan=new WildcardObject(this.data,this.options.delimiter,this.options.wildcard),this.destroyed=!1}getDefaultListenerOptions(){return{bulk:!1,bulkValue:this.options.defaultBulkValue,debug:!1,source:"",data:void 0,queue:!1,group:!1}}cacheGet(r,n=this.data,s=!1){const i=r.join(this.options.delimiter),o=this.cache.get(i);if(o){const u=o.deref();if(u)return u}const c=ObjectPath.get(r,n,s);return(isObject$2(c)||Array.isArray(c))&&this.cache.set(i,new WeakRef(c)),c}cacheSet(r,n,s=this.data){const i=r.join(this.options.delimiter);return isObject$2(n)||Array.isArray(n)?this.cache.set(i,new WeakRef(n)):this.cache.delete(i),ObjectPath.set(r,n,s)}silentSet(r,n){return this.pathSet(this.split(r),n,this.data)}loadWasmMatcher(r){return __awaiter(this,void 0,void 0,function*(){yield init(r),this.is_match=is_match,this.scan=new WildcardObject(this.data,this.options.delimiter,this.options.wildcard,this.is_match)})}same(r,n){return(["number","string","undefined","boolean"].includes(typeof r)||r===null)&&n===r}getListeners(){return this.listeners}destroy(){this.destroyed=!0,this.data=void 0,this.listeners=new Map,this.waitingListeners=new Map,this.updateQueue=[],this.jobsRunning=0}match(r,n,s=!0){return this.is_match?this.is_match(r,n):r===n||r===this.options.wildcard||n===this.options.wildcard?!0:!s&&this.getIndicesCount(this.options.delimiter,r)<this.getIndicesCount(this.options.delimiter,n)?!1:this.scan.match(r,n)}getIndicesOf(r,n){if(this.options.useIndicesCache&&this.indices.has(n))return this.indices.get(n);const s=r.length;if(s==0)return[];let i=0,o,c=[];for(;(o=n.indexOf(r,i))>-1;)c.push(o),i=o+s;return this.options.useIndicesCache&&this.indices.set(n,c),c}getIndicesCount(r,n){if(this.options.useIndicesCache&&this.indicesCount.has(n))return this.indicesCount.get(n);const s=r.length;if(s==0)return 0;let i=0,o,c=0;for(;(o=n.indexOf(r,i))>-1;)c++,i=o+s;return this.options.useIndicesCache&&this.indicesCount.set(n,c),c}cutPath(r,n){if(n==="")return"";if(r=this.cleanNotRecursivePath(r),n=this.cleanNotRecursivePath(n),r===n)return r;const s=this.getIndicesCount(this.options.delimiter,n),i=this.getIndicesOf(this.options.delimiter,r);return r.substring(0,i[s])}trimPath(r){return r=this.cleanNotRecursivePath(r),r.charAt(0)===this.options.delimiter?r.substr(1):r}split(r){if(r==="")return[];if(!this.options.useSplitCache)return r.split(this.options.delimiter);const n=this.splitCache.get(r);if(n)return n.slice();const s=r.split(this.options.delimiter);return this.splitCache.set(r,s.slice()),s}isWildcard(r){return r.includes(this.options.wildcard)||this.hasParams(r)}isNotRecursive(r){return r.endsWith(this.options.notRecursive)}cleanNotRecursivePath(r){return this.isNotRecursive(r)?r.substring(0,r.length-1):r}hasParams(r){return r.includes(this.options.param)}getParamsInfo(r){let n={replaced:"",original:r,params:{}},s=0,i=[];for(const o of this.split(r)){n.params[s]={original:o,replaced:"",name:""};const c=new RegExp("\\".concat(this.options.param,"([^\\").concat(this.options.delimiter,"\\").concat(this.options.param,"]+)"),"g");let u=c.exec(o);if(u)n.params[s].name=u[1];else{delete n.params[s],i.push(o),s++;continue}c.lastIndex=0,n.params[s].replaced=o.replace(c,this.options.wildcard),i.push(n.params[s].replaced),s++}return n.replaced=i.join(this.options.delimiter),n}getParams(r,n){if(!r)return;const s=this.split(n),i={};for(const o in r.params){const c=r.params[o];i[c.name]=s[o]}return i}waitForAll(r,n){const s={};for(let i of r)s[i]={dirty:!1},this.hasParams(i)&&(s[i].paramsInfo=this.getParamsInfo(i)),s[i].isWildcard=this.isWildcard(i),s[i].isRecursive=!this.isNotRecursive(i);return this.waitingListeners.set(r,{fn:n,paths:s}),n(s),function(){this.waitingListeners.delete(r)}}executeWaitingListeners(r){if(!this.destroyed)for(const n of this.waitingListeners.values()){const{fn:s,paths:i}=n;let o=0,c=0;for(let u in i){const l=i[u];let f=!1;l.isRecursive&&(r=this.cutPath(r,u)),l.isWildcard&&this.match(u,r)&&(f=!0),r===u&&(f=!0),f&&(l.dirty=!0),l.dirty&&o++,c++}o===c&&s(i)}}subscribeAll(r,n,s=this.getDefaultListenerOptions()){if(this.destroyed)return()=>{};let i=[],o=0,c=null;typeof s.group=="boolean"&&s.group?(this.groupId++,c=this.groupId,s.bulk=!0):typeof s.group=="string"&&(s.bulk=!0,c=s.group);for(const u of r)i.push(this.subscribe(u,n,s,{all:r,index:o,groupId:c})),o++;return function(){for(const l of i)l()}}getCleanListenersCollection(r={}){return Object.assign({listeners:new Map,isRecursive:!1,isWildcard:!1,hasParams:!1,match:void 0,paramsInfo:void 0,path:void 0,originalPath:void 0,count:0},r)}getCleanListener(r,n=this.getDefaultListenerOptions()){return{fn:r,options:Object.assign(Object.assign({},this.getDefaultListenerOptions()),n),groupId:null}}getListenerCollectionMatch(r,n,s){r=this.cleanNotRecursivePath(r);const i=this;return function(c,u=!1){let l=r;return n?c=i.cutPath(c,r):l=i.cutPath(i.cleanNotRecursivePath(r),c),u&&console.log("[getListenerCollectionMatch]",{listenerPath:r,scopedListenerPath:l,path:c,isRecursive:n,isWildcard:s}),s&&i.match(l,c,n)?!0:l===c}}getListenersCollection(r,n){if(this.listeners.has(r)){let u=this.listeners.get(r);return u.listeners.set(++this.id,n),n.id=this.id,u}const s=this.hasParams(r);let i;s&&(i=this.getParamsInfo(r));let o={isRecursive:!this.isNotRecursive(r),isWildcard:this.isWildcard(r),hasParams:s,paramsInfo:i,originalPath:r,path:s?i.replaced:r};o.isRecursive||(o.path=this.cleanNotRecursivePath(o.path));let c=this.getCleanListenersCollection(Object.assign(Object.assign({},o),{match:this.getListenerCollectionMatch(o.path,o.isRecursive,o.isWildcard)}));return this.id++,c.listeners.set(this.id,n),n.id=this.id,this.listeners.set(o.originalPath,c),c}subscribe(r,n,s=this.getDefaultListenerOptions(),i={all:[r],index:0,groupId:null}){if(this.destroyed)return()=>{};this.jobsRunning++;const o="subscribe";let c=this.getCleanListener(n,s);s.group&&(s.bulk=!0,typeof s.group=="string"?c.groupId=s.group:i.groupId&&(c.groupId=i.groupId)),this.listenersIgnoreCache.set(c,{truthy:[],falsy:[]});const u=this.getListenersCollection(r,c);s.debug&&console.log("[subscribe]",{listenerPath:r,options:s}),u.count++;let l=!0;if(c.groupId&&(typeof c.groupId=="string"?this.namedGroups.includes(c.groupId)?l=!1:this.namedGroups.push(c.groupId):typeof c.groupId=="number"&&(this.numberGroups.includes(c.groupId)?l=!1:this.numberGroups.push(c.groupId))),l){const f=this.cleanNotRecursivePath(u.path),d=this.split(f);if(!u.isWildcard)!this.isMuted(f)&&!this.isMuted(n)&&n(this.pathGet(d,this.data),{type:o,listener:c,listenersCollection:u,path:{listener:r,update:void 0,resolved:this.cleanNotRecursivePath(r)},params:this.getParams(u.paramsInfo,f),options:s});else{const h=this.scan.get(f);if(s.bulk){const y=[];for(const b in h)this.isMuted(b)||y.push({path:b,params:this.getParams(u.paramsInfo,b),value:h[b]});this.isMuted(n)||n(y,{type:o,listener:c,listenersCollection:u,path:{listener:r,update:void 0,resolved:void 0},options:s,params:void 0})}else for(const y in h)!this.isMuted(y)&&!this.isMuted(n)&&n(h[y],{type:o,listener:c,listenersCollection:u,path:{listener:r,update:void 0,resolved:this.cleanNotRecursivePath(y)},params:this.getParams(u.paramsInfo,y),options:s})}}return this.debugSubscribe(c,u,r),this.jobsRunning--,this.unsubscribe(r,this.id)}unsubscribe(r,n){const s=this.listeners,i=s.get(r);return function(){i.listeners.delete(n),i.count--,i.count===0&&s.delete(r)}}runQueuedListeners(){if(!this.destroyed&&this.subscribeQueue.length!==0)if(this.jobsRunning===0){this.queueRuns=0;const r=[...this.subscribeQueue];for(let n=0,s=r.length;n<s;n++)r[n]();this.subscribeQueue.length=0}else{if(this.queueRuns++,this.queueRuns>=this.options.maxQueueRuns)throw this.queueRuns=0,new Error("Maximal number of queue runs exhausted.");Promise.resolve().then(()=>this.runQueuedListeners()).catch(r=>{throw r})}}getQueueNotifyListeners(r,n=[]){for(const s in r){if(this.isMuted(s))continue;let{single:i,bulk:o}=r[s];for(const c of i){let u=!1,l=c.listener.id+":"+c.eventInfo.path.resolved;c.eventInfo.path.resolved||(l=c.listener.id+":"+c.eventInfo.path.listener);for(const d of n)if(l===d.resolvedIdPath){u=!0;break}if(u)continue;const f=this.debugTime(c);if(!this.isMuted(c.listener.fn))if(c.listener.options.queue&&this.jobsRunning)this.subscribeQueue.push(()=>{c.listener.fn(c.value?c.value():void 0,c.eventInfo)});else{let d=c.listener.id+":"+c.eventInfo.path.resolved;c.eventInfo.path.resolved||(d=c.listener.id+":"+c.eventInfo.path.listener),n.push({id:c.listener.id,resolvedPath:c.eventInfo.path.resolved,resolvedIdPath:d,originalFn:c.listener.fn,fn:()=>{c.listener.fn(c.value?c.value():void 0,c.eventInfo)},options:c.listener.options,groupId:c.listener.groupId})}this.debugListener(f,c)}for(const c of o){let u=!1;for(const d of n)if(d.id===c.listener.id){u=!0;break}if(u)continue;const l=this.debugTime(c),f=[];for(const d of c.value)f.push(Object.assign(Object.assign({},d),{value:d.value?d.value():void 0}));if(!this.isMuted(c.listener.fn))if(c.listener.options.queue&&this.jobsRunning)this.subscribeQueue.push(()=>this.jobsRunning?!1:(c.listener.fn(f,c.eventInfo),!0));else{let d=c.listener.id+":"+c.eventInfo.path.resolved;c.eventInfo.path.resolved||(d=c.listener.id+":"+c.eventInfo.path.listener),n.push({id:c.listener.id,resolvedPath:c.eventInfo.path.resolved,resolvedIdPath:d,originalFn:c.listener.fn,fn:()=>{c.listener.fn(f,c.eventInfo)},options:c.listener.options,groupId:c.listener.groupId})}this.debugListener(l,c)}}return Promise.resolve().then(()=>this.runQueuedListeners()),n}shouldIgnore(r,n){if(!r.options.ignore)return!1;for(const s of r.options.ignore){if(n.startsWith(s)||this.is_match&&this.is_match(s,n))return!0;{const i=this.cutPath(n,s);if(this.match(s,i))return!0}}return!1}getSubscribedListeners(r,n,s,i="update",o=null){s=Object.assign(Object.assign({},defaultUpdateOptions),s);const c={};for(let[u,l]of this.listeners)if(l.match(r)){c[u]={single:[],bulk:[],bulkData:[]};const f=l.paramsInfo?this.getParams(l.paramsInfo,r):void 0,d=this.cutPath(r,u),y=l.isRecursive||l.isWildcard?()=>this.get(d):()=>n,b=[{value:y,path:r,params:f}];for(const v of l.listeners.values()){if(this.shouldIgnore(v,r)){v.options.debug&&console.log("[getSubscribedListeners] Listener was not fired because it was ignored.",{listener:v,listenersCollection:l});continue}v.options.bulk?c[u].bulk.push({listener:v,listenersCollection:l,eventInfo:{type:i,listener:v,path:{listener:u,update:o||r,resolved:void 0},params:f,options:s},value:b}):c[u].single.push({listener:v,listenersCollection:l,eventInfo:{type:i,listener:v,path:{listener:u,update:o||r,resolved:this.cleanNotRecursivePath(r)},params:f,options:s},value:y})}}else if(this.options.extraDebug){let f=!1;for(const d of l.listeners.values())d.options.debug&&(f=!0,console.log("[getSubscribedListeners] Listener was not fired because there was no match.",{listener:d,listenersCollection:l,updatePath:r}));f&&l.match(r,!0)}return c}notifySubscribedListeners(r,n,s,i="update",o=null){return this.getQueueNotifyListeners(this.getSubscribedListeners(r,n,s,i,o))}useBulkValue(r){for(const[n,s]of r.listeners)if(s.options.bulk&&s.options.bulkValue||!s.options.bulk)return!0;return!1}getNestedListeners(r,n,s,i="update",o=null){const c={},u={};for(let[l,f]of this.listeners){if(!f.isRecursive)continue;const d=this.cutPath(l,r);if(this.match(d,r)){c[l]={single:[],bulk:[]};const h=this.trimPath(l.substr(d.length)),y=this.useBulkValue(f);let b;y&&(b=u[h]?u[h]:new WildcardObject(n,this.options.delimiter,this.options.wildcard).get(h),u[h]=b);const v=f.paramsInfo?this.getParams(f.paramsInfo,r):void 0,j=[],w={};for(const[I,P]of f.listeners)if(y)for(const x in b){const p=()=>b[x],m=[r,x].join(this.options.delimiter),T={type:i,listener:P,listenersCollection:f,path:{listener:l,update:o||r,resolved:this.cleanNotRecursivePath(m)},params:v,options:s};this.shouldIgnore(P,r)||(P.options.bulk?(j.push({value:p,path:m,params:v}),w[I]=P):c[l].single.push({listener:P,listenersCollection:f,eventInfo:T,value:p}))}else{const x={type:i,listener:P,listenersCollection:f,path:{listener:l,update:o||r,resolved:void 0},params:v,options:s};if(this.shouldIgnore(P,r))continue;P.options.bulk?(j.push({value:void 0,path:void 0,params:v}),w[I]=P):c[l].single.push({listener:P,listenersCollection:f,eventInfo:x,value:void 0})}for(const I in w){const P=w[I],x={type:i,listener:P,listenersCollection:f,path:{listener:l,update:r,resolved:void 0},options:s,params:v};c[l].bulk.push({listener:P,listenersCollection:f,eventInfo:x,value:j})}}else if(this.options.extraDebug)for(const h of f.listeners.values())h.options.debug&&console.log("[getNestedListeners] Listener was not fired because there was no match.",{listener:h,listenersCollection:f,currentCutPath:d,updatePath:r})}return c}notifyNestedListeners(r,n,s,i="update",o,c=null){return this.getQueueNotifyListeners(this.getNestedListeners(r,n,s,i,c),o)}getNotifyOnlyListeners(r,n,s,i="update",o=null){const c={};if(typeof s.only!="object"||!Array.isArray(s.only)||typeof s.only[0]>"u"||!this.canBeNested(n))return c;for(const u of s.only){const l=new WildcardObject(n,this.options.delimiter,this.options.wildcard).get(u);c[u]={bulk:[],single:[]};for(const f in l){const d=r+this.options.delimiter+f;for(const[h,y]of this.listeners){const b=y.paramsInfo?this.getParams(y.paramsInfo,d):void 0;if(this.match(h,d)){const v=()=>l[f],j=[{value:v,path:d,params:b}];for(const w of y.listeners.values()){const I={type:i,listener:w,listenersCollection:y,path:{listener:h,update:o||r,resolved:this.cleanNotRecursivePath(d)},params:b,options:s};this.shouldIgnore(w,r)||(w.options.bulk?c[u].bulk.some(P=>P.listener===w)||c[u].bulk.push({listener:w,listenersCollection:y,eventInfo:I,value:j}):c[u].single.push({listener:w,listenersCollection:y,eventInfo:I,value:v}))}}}}}return c}runQueue(r){const n=[];for(const s of r)s.options.group?n.includes(s.groupId)||(s.fn(),n.push(s.groupId)):s.fn()}sortAndRunQueue(r,n){r.sort(function(s,i){return s.id-i.id}),this.options.debug&&console.log("[deep-state-observer] queue for ".concat(n),r),this.runQueue(r)}notifyOnly(r,n,s,i="update",o=""){const c=this.getQueueNotifyListeners(this.getNotifyOnlyListeners(r,n,s,i,o));this.sortAndRunQueue(c,r)}canBeNested(r){return typeof r=="object"&&r!==null}getUpdateValues(r,n){let s=n;return typeof n=="function"&&(s=n(r)),{newValue:s,oldValue:r}}wildcardNotify(r,n){let s=[];for(const i of r)this.getQueueNotifyListeners(i,s);for(const i of n)this.executeWaitingListeners(i);return this.jobsRunning--,s}wildcardUpdate(r,n,s=defaultUpdateOptions,i=!1){++this.jobsRunning,s=Object.assign(Object.assign({},defaultUpdateOptions),s);const o=this.scan.get(r),c={};for(const d in o){const h=this.split(d),{oldValue:y,newValue:b}=this.getUpdateValues(o[d],n);(!this.same(b,y)||s.force)&&(this.pathSet(h,b,this.data),c[d]=b)}const u=[],l=[];for(const d in c){const h=c[d];s.only.length?u.push(this.getNotifyOnlyListeners(d,h,s,"update",r)):(u.push(this.getSubscribedListeners(d,h,s,"update",r)),this.canBeNested(h)&&u.push(this.getNestedListeners(d,h,s,"update",r))),s.debug&&this.options.log("Wildcard update",{path:d,newValue:h}),l.push(d)}if(i){const d=this;return function(){const h=d.wildcardNotify(u,l);d.sortAndRunQueue(h,r)}}const f=this.wildcardNotify(u,l);this.sortAndRunQueue(f,r)}runUpdateQueue(){if(!this.destroyed)for(;this.updateQueue.length&&this.updateQueue.length<this.options.maxSimultaneousJobs;){const r=this.updateQueue.shift();r.options.queue=!1,this.update(r.updatePath,r.fnOrValue,r.options,r.multi)}}updateNotify(r,n,s){const i=this.notifySubscribedListeners(r,n,s);this.canBeNested(n)&&this.notifyNestedListeners(r,n,s,"update",i),this.sortAndRunQueue(i,r),this.executeWaitingListeners(r)}updateNotifyAll(r){let n=[];for(const s of r){const i=s.newValue;if(this.tracing.length){const o=this.tracing[this.tracing.length-1],c=this.traceMap.get(o);c.changed.push({traceId:o,updatePath:s.updatePath,fnOrValue:i,options:s.options}),this.traceMap.set(o,c)}n=n.concat(this.notifySubscribedListeners(s.updatePath,i,s.options)),this.canBeNested(s.newValue)&&this.notifyNestedListeners(s.updatePath,i,s.options,"update",n)}this.runQueue(n)}updateNotifyOnly(r,n,s){this.notifyOnly(r,n,s),this.executeWaitingListeners(r)}update(r,n,s=Object.assign({},defaultUpdateOptions),i=!1){if(this.destroyed)return;if(this.collection)return this.collection.update(r,n,s);if(this.tracing.length){const d=this.tracing[this.tracing.length-1],h=this.traceMap.get(d);h.changed.push({traceId:d,updatePath:r,fnOrValue:n,options:s}),this.traceMap.set(d,h)}const o=this.jobsRunning;if((this.options.queue||s.queue)&&o){if(o>this.options.maxSimultaneousJobs)throw new Error("Maximal simultaneous jobs limit reached.");this.updateQueue.push({updatePath:r,fnOrValue:n,options:s,multi:i});const d=Promise.resolve().then(()=>{this.runUpdateQueue()});return i?function(){return d}:d}if(this.isWildcard(r))return this.wildcardUpdate(r,n,s,i);++this.jobsRunning;const c=this.split(r),u=this.pathGet(c,this.data);let{oldValue:l,newValue:f}=this.getUpdateValues(u,n);if(s.debug&&this.options.log("Updating ".concat(r," ").concat(s.source?"from ".concat(s.source):""),{oldValue:l,newValue:f}),this.same(f,l)&&!s.force)return--this.jobsRunning,i?function(){return f}:f;if(this.pathSet(c,f,this.data),s=Object.assign(Object.assign({},defaultUpdateOptions),s),s.only===null)return--this.jobsRunning,i?function(){}:f;if(s.only.length){if(--this.jobsRunning,i){const d=this;return function(){return d.updateNotifyOnly(r,f,s)}}return this.updateNotifyOnly(r,f,s),f}if(i){--this.jobsRunning;const d=this;return function(){return d.updateNotify(r,f,s)}}return this.updateNotify(r,f,s),--this.jobsRunning,f}multi(r=!1){if(this.destroyed)return{update(){return this},done(){},getStack(){return[]}};if(this.collection)return this.collection;const n=this,s=[],i=[];return{update(c,u,l=defaultUpdateOptions){if(r){const f=n.split(c);let d=u;const h=n.pathGet(f,n.data);typeof d=="function"&&(d=d(h)),n.pathSet(f,d,n.data),s.push({updatePath:c,newValue:d,options:l})}else i.push(n.update(c,u,l,!0));return this},done(){if(n.collections===0){if(r)n.updateNotifyAll(s);else for(const c of i)c();s.length=0}},getStack(){return s}}}collect(){return this.collections++,this.collection||(this.collection=this.multi(!0)),this.collection}executeCollected(){if(this.collections--,this.collections===0&&this.collection){const r=this.collection;this.collection=null,r.done()}}getCollectedCount(){return this.collections}getCollectedStack(){return this.collection?this.collection.getStack():[]}get(r=void 0){if(!this.destroyed)return r===void 0||r===""?this.data:this.isWildcard(r)?this.scan.get(r):this.pathGet(this.split(r),this.data)}last(r){let n=this.lastExecs.get(r);n||(n={calls:0},this.lastExecs.set(r,n));const s=++n.calls;this.resolved.then(()=>{s===n.calls&&(this.lastExecs.set(r,{calls:0}),r())})}isMuted(r){if(!this.options.useMute)return!1;if(typeof r=="function")return this.isMutedListener(r);for(const n of this.muted){const s=!this.isNotRecursive(n),i=this.trimPath(n);if(this.match(r,i)||this.match(i,r))return!0;if(s){const o=this.cutPath(i,r);if(this.match(o,n)||this.match(n,o))return!0}}return!1}isMutedListener(r){return this.mutedListeners.has(r)}mute(r){if(typeof r=="function")return this.mutedListeners.add(r);this.muted.add(r)}unmute(r){if(typeof r=="function")return this.mutedListeners.delete(r);this.muted.delete(r)}debugSubscribe(r,n,s){r.options.debug&&this.options.log("listener subscribed",{listenerPath:s,listener:r,listenersCollection:n})}debugListener(r,n){(n.eventInfo.options.debug||n.listener.options.debug)&&this.options.log("Listener fired",{time:Date.now()-r,info:n})}debugTime(r){return r.listener.options.debug||r.eventInfo.options.debug?Date.now():0}startTrace(r,n=null){this.traceId++;const s=this.traceId+":"+r;return this.traceMap.set(s,{id:s,sort:this.traceId,stack:this.tracing.map(i=>i),additionalData:n,changed:[]}),this.tracing.push(s),s}stopTrace(r){const n=this.traceMap.get(r);return this.tracing.pop(),this.traceMap.delete(r),n}saveTrace(r){const n=this.traceMap.get(r);return this.tracing.pop(),this.traceMap.delete(r),this.savedTrace.push(n),n}getSavedTraces(){const r=this.savedTrace.map(n=>n);return r.sort((n,s)=>n.sort-s.sort),this.savedTrace=[],r}}var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto$c=Object.prototype,hasOwnProperty$9=objectProto$c.hasOwnProperty,nativeObjectToString$1=objectProto$c.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(e){var r=hasOwnProperty$9.call(e,symToStringTag$1),n=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var s=!0}catch(o){}var i=nativeObjectToString$1.call(e);return s&&(r?e[symToStringTag$1]=n:delete e[symToStringTag$1]),i}var objectProto$b=Object.prototype,nativeObjectToString=objectProto$b.toString;function objectToString(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(e){return e==null?e===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString(e)}function isObjectLike(e){return e!=null&&typeof e=="object"}var isArray=Array.isArray;function isObject$1(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function identity(e){return e}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject$1(e))return!1;var r=baseGetTag(e);return r==funcTag$2||r==genTag$1||r==asyncTag||r==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(e){if(e!=null){try{return funcToString$1.call(e)}catch(r){}try{return e+""}catch(r){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$a=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$8=objectProto$a.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$8).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){if(!isObject$1(e)||isMasked(e))return!1;var r=isFunction(e)?reIsNative:reIsHostCtor;return r.test(toSource(e))}function getValue(e,r){return e==null?void 0:e[r]}function getNative(e,r){var n=getValue(e,r);return baseIsNative(n)?n:void 0}var WeakMap$1=getNative(root,"WeakMap"),objectCreate=Object.create,baseCreate=function(){function e(){}return function(r){if(!isObject$1(r))return{};if(objectCreate)return objectCreate(r);e.prototype=r;var n=new e;return e.prototype=void 0,n}}();function apply(e,r,n){switch(n.length){case 0:return e.call(r);case 1:return e.call(r,n[0]);case 2:return e.call(r,n[0],n[1]);case 3:return e.call(r,n[0],n[1],n[2])}return e.apply(r,n)}function noop(){}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var r=0,n=0;return function(){var s=nativeNow(),i=HOT_SPAN-(s-n);if(n=s,i>0){if(++r>=HOT_COUNT)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(r){}}(),baseSetToString=defineProperty?function(e,r){return defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant(r),writable:!0})}:identity,setToString=shortOut(baseSetToString);function arrayEach(e,r){for(var n=-1,s=e==null?0:e.length;++n<s&&r(e[n],n,e)!==!1;);return e}function baseFindIndex(e,r,n,s){for(var i=e.length,o=n+-1;++o<i;)if(r(e[o],o,e))return o;return-1}function baseIsNaN(e){return e!==e}function strictIndexOf(e,r,n){for(var s=n-1,i=e.length;++s<i;)if(e[s]===r)return s;return-1}function baseIndexOf(e,r,n){return r===r?strictIndexOf(e,r,n):baseFindIndex(e,baseIsNaN,n)}function arrayIncludes(e,r){var n=e==null?0:e.length;return!!n&&baseIndexOf(e,r,0)>-1}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,r){var n=typeof e;return r=r==null?MAX_SAFE_INTEGER$1:r,!!r&&(n=="number"||n!="symbol"&&reIsUint.test(e))&&e>-1&&e%1==0&&e<r}function baseAssignValue(e,r,n){r=="__proto__"&&defineProperty?defineProperty(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}function eq(e,r){return e===r||e!==e&&r!==r}var objectProto$9=Object.prototype,hasOwnProperty$7=objectProto$9.hasOwnProperty;function assignValue(e,r,n){var s=e[r];(!(hasOwnProperty$7.call(e,r)&&eq(s,n))||n===void 0&&!(r in e))&&baseAssignValue(e,r,n)}var nativeMax=Math.max;function overRest(e,r,n){return r=nativeMax(r===void 0?e.length-1:r,0),function(){for(var s=arguments,i=-1,o=nativeMax(s.length-r,0),c=Array(o);++i<o;)c[i]=s[r+i];i=-1;for(var u=Array(r+1);++i<r;)u[i]=s[i];return u[r]=n(c),apply(e,this,u)}}function baseRest(e,r){return setToString(overRest(e,r,identity),e+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}function isArrayLike(e){return e!=null&&isLength(e.length)&&!isFunction(e)}var objectProto$8=Object.prototype;function isPrototype(e){var r=e&&e.constructor,n=typeof r=="function"&&r.prototype||objectProto$8;return e===n}function baseTimes(e,r){for(var n=-1,s=Array(e);++n<e;)s[n]=r(n);return s}var argsTag$2="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag$2}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty,propertyIsEnumerable$1=objectProto$7.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$6.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")};function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$1="[object Function]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$2="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$2]=typedArrayTags[boolTag$2]=typedArrayTags[dataViewTag$3]=typedArrayTags[dateTag$2]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$4]=typedArrayTags[numberTag$2]=typedArrayTags[objectTag$2]=typedArrayTags[regexpTag$2]=typedArrayTags[setTag$4]=typedArrayTags[stringTag$2]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(e){return function(r){return e(r)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(r){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function arrayLikeKeys(e,r){var n=isArray(e),s=!n&&isArguments(e),i=!n&&!s&&isBuffer(e),o=!n&&!s&&!i&&isTypedArray(e),c=n||s||i||o,u=c?baseTimes(e.length,String):[],l=u.length;for(var f in e)hasOwnProperty$5.call(e,f)&&!(c&&(f=="length"||i&&(f=="offset"||f=="parent")||o&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||isIndex(f,l)))&&u.push(f);return u}function overArg(e,r){return function(n){return e(r(n))}}var nativeKeys=overArg(Object.keys,Object),objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var r=[];for(var n in Object(e))hasOwnProperty$4.call(e,n)&&n!="constructor"&&r.push(n);return r}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function hashGet(e){var r=this.__data__;if(nativeCreate){var n=r[e];return n===HASH_UNDEFINED$2?void 0:n}return hasOwnProperty$2.call(r,e)?r[e]:void 0}var objectProto$2=Object.prototype,hasOwnProperty$1=objectProto$2.hasOwnProperty;function hashHas(e){var r=this.__data__;return nativeCreate?r[e]!==void 0:hasOwnProperty$1.call(r,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,r){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nativeCreate&&r===void 0?HASH_UNDEFINED$1:r,this}function Hash(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,r){for(var n=e.length;n--;)if(eq(e[n][0],r))return n;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var r=this.__data__,n=assocIndexOf(r,e);if(n<0)return!1;var s=r.length-1;return n==s?r.pop():splice.call(r,n,1),--this.size,!0}function listCacheGet(e){var r=this.__data__,n=assocIndexOf(r,e);return n<0?void 0:r[n][1]}function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1}function listCacheSet(e,r){var n=this.__data__,s=assocIndexOf(n,e);return s<0?(++this.size,n.push([e,r])):n[s][1]=r,this}function ListCache(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function getMapData(e,r){var n=e.__data__;return isKeyable(r)?n[typeof r=="string"?"string":"hash"]:n.map}function mapCacheDelete(e){var r=getMapData(this,e).delete(e);return this.size-=r?1:0,r}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,r){var n=getMapData(this,e),s=n.size;return n.set(e,r),this.size+=n.size==s?0:1,this}function MapCache(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var s=e[r];this.set(s[0],s[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;function arrayPush(e,r){for(var n=-1,s=r.length,i=e.length;++n<s;)e[i+n]=r[n];return e}var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(e){return isArray(e)||isArguments(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,r,n,s,i){var o=-1,c=e.length;for(n||(n=isFlattenable),i||(i=[]);++o<c;){var u=e[o];n(u)&&arrayPush(i,u)}return i}var getPrototype=overArg(Object.getPrototypeOf,Object);function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE$1=200;function stackSet(e,r){var n=this.__data__;if(n instanceof ListCache){var s=n.__data__;if(!Map$1||s.length<LARGE_ARRAY_SIZE$1-1)return s.push([e,r]),this.size=++n.size,this;n=this.__data__=new MapCache(s)}return n.set(e,r),this.size=n.size,this}function Stack(e){var r=this.__data__=new ListCache(e);this.size=r.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0;Buffer&&Buffer.allocUnsafe;function cloneBuffer(e,r){return e.slice()}function arrayFilter(e,r){for(var n=-1,s=e==null?0:e.length,i=0,o=[];++n<s;){var c=e[n];r(c,n,e)&&(o[i++]=c)}return o}function stubArray(){return[]}var objectProto$1=Object.prototype,propertyIsEnumerable=objectProto$1.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(e){return e==null?[]:(e=Object(e),arrayFilter(nativeGetSymbols$1(e),function(r){return propertyIsEnumerable.call(e,r)}))}:stubArray;function baseGetAllKeys(e,r,n){var s=r(e);return isArray(e)?s:arrayPush(s,n(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols)}var DataView=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set$1=getNative(root,"Set"),mapTag$3="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$3="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$2="[object DataView]",dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$2||Map$1&&getTag(new Map$1)!=mapTag$3||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$3||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1)&&(getTag=function(e){var r=baseGetTag(e),n=r==objectTag$1?e.constructor:void 0,s=n?toSource(n):"";if(s)switch(s){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$3;case promiseCtorString:return promiseTag;case setCtorString:return setTag$3;case weakMapCtorString:return weakMapTag$1}return r});var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function initCloneArray(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&hasOwnProperty.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var Uint8Array$1=root.Uint8Array;function cloneArrayBuffer(e){var r=new e.constructor(e.byteLength);return new Uint8Array$1(r).set(new Uint8Array$1(e)),r}function cloneDataView(e,r){var n=cloneArrayBuffer(e.buffer);return new e.constructor(n,e.byteOffset,e.byteLength)}var reFlags=/\w*$/;function cloneRegExp(e){var r=new e.constructor(e.source,reFlags.exec(e));return r.lastIndex=e.lastIndex,r}var symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}function cloneTypedArray(e,r){var n=cloneArrayBuffer(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}var boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,r,n){var s=e.constructor;switch(r){case arrayBufferTag$1:return cloneArrayBuffer(e);case boolTag$1:case dateTag$1:return new s(+e);case dataViewTag$1:return cloneDataView(e);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e);case mapTag$2:return new s;case numberTag$1:case stringTag$1:return new s(e);case regexpTag$1:return cloneRegExp(e);case setTag$2:return new s;case symbolTag$1:return cloneSymbol(e)}}function initCloneObject(e){return typeof e.constructor=="function"&&!isPrototype(e)?baseCreate(getPrototype(e)):{}}var mapTag$1="[object Map]";function baseIsMap(e){return isObjectLike(e)&&getTag(e)==mapTag$1}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$1="[object Set]";function baseIsSet(e){return isObjectLike(e)&&getTag(e)==setTag$1}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(e,r,n,s,i,o){var c;if(c!==void 0)return c;if(!isObject$1(e))return e;var u=isArray(e);if(u)c=initCloneArray(e);else{var l=getTag(e),f=l==funcTag||l==genTag;if(isBuffer(e))return cloneBuffer(e);if(l==objectTag||l==argsTag||f&&!i)c=f?{}:initCloneObject(e);else{if(!cloneableTags[l])return i?e:{};c=initCloneByTag(e,l)}}o||(o=new Stack);var d=o.get(e);if(d)return d;o.set(e,c),isSet(e)?e.forEach(function(b){c.add(baseClone(b,r,n,b,e,o))}):isMap(e)&&e.forEach(function(b,v){c.set(v,baseClone(b,r,n,v,e,o))});var h=getAllKeys,y=u?void 0:h(e);return arrayEach(y||e,function(b,v){y&&(v=b,b=e[v]),assignValue(c,v,baseClone(b,r,n,v,e,o))}),c}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var r=-1,n=e==null?0:e.length;for(this.__data__=new MapCache;++r<n;)this.add(e[r])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function cacheHas(e,r){return e.has(r)}function setToArray(e){var r=-1,n=Array(e.size);return e.forEach(function(s){n[++r]=s}),n}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}var INFINITY=1/0,createSet=Set$1&&1/setToArray(new Set$1([,-0]))[1]==INFINITY?function(e){return new Set$1(e)}:noop,LARGE_ARRAY_SIZE=200;function baseUniq(e,r,n){var s=-1,i=arrayIncludes,o=e.length,c=!0,u=[],l=u;if(o>=LARGE_ARRAY_SIZE){var f=createSet(e);if(f)return setToArray(f);c=!1,i=cacheHas,l=new SetCache}else l=u;e:for(;++s<o;){var d=e[s],h=d;if(d=d!==0?d:0,c&&h===h){for(var y=l.length;y--;)if(l[y]===h)continue e;u.push(d)}else i(l,h,n)||(l!==u&&l.push(h),u.push(d))}return u}var union=baseRest(function(e){return baseUniq(baseFlatten(e,1,isArrayLikeObject))});class ObservedData{}class SimpleObservedData extends ObservedData{constructor(n){super();$(this,"data",{});$(this,"event",new eventsExports.EventEmitter);this.data=n}update(n,s){s?setValueByKeyPath(s,n,this.data):this.data=n;const i={updateData:n,path:s!=null?s:""};s&&this.event.emit(s,i),this.event.emit("",i)}on(n,s){this.event.on(n,s)}off(n,s){this.event.off(n,s)}getData(n){return n?getValueByKeyPath(n,this.data):this.data}destroy(){}}var X,G,W,U,k,V;class DataSource extends EventEmitter$1{constructor(n){var o,c,u,l,f;super();$(this,"isInit",!1);$(this,"app");$(this,"mockData");N(this,X,"base");N(this,G);N(this,W);N(this,U);N(this,k,[]);N(this,V,[]);q(this,G,n.schema.id),q(this,W,n.schema),this.app=n.app,this.setFields(n.schema.fields),this.setMethods(n.schema.methods||[]);let s=n.initialData;const i=n.ObservedDataClass||SimpleObservedData;if(this.app.platform==="editor")this.mockData=((c=(o=n.schema.mocks)==null?void 0:o.find(d=>d.useInEditor))==null?void 0:c.data)||this.getDefaultData(),s=cloneDeep(this.mockData);else if(typeof n.useMock=="boolean"&&n.useMock)this.mockData=(l=(u=n.schema.mocks)==null?void 0:u.find(d=>d.enable))==null?void 0:l.data,s=this.mockData||this.getDefaultData();else if(!n.initialData)s=this.getDefaultData();else{q(this,U,new i((f=n.initialData)!=null?f:{})),this.isInit=!0;return}q(this,U,new i(s!=null?s:{}))}get id(){return L(this,G)}get type(){return L(this,X)}get schema(){return L(this,W)}get fields(){return L(this,k)}get methods(){return L(this,V)}setFields(n){q(this,k,n)}setMethods(n){q(this,V,n)}get data(){return L(this,U).getData("")}setData(n,s){L(this,U).update(n,s);const i={updateData:n,path:s};this.emit("change",i)}setValue(n,s){return this.setData(s,n)}onDataChange(n,s){L(this,U).on(n,s)}offDataChange(n,s){L(this,U).off(n,s)}getDefaultData(){return getDefaultValueFromFields(L(this,k))}async init(){this.isInit=!0}destroy(){q(this,k,[]),this.removeAllListeners(),L(this,U).destroy()}}X=new WeakMap,G=new WeakMap,W=new WeakMap,U=new WeakMap,k=new WeakMap,V=new WeakMap;const urlencoded=e=>Object.entries(e).reduce((r,[n,s])=>{let i=s;return typeof s=="object"&&(i=JSON.stringify(s)),typeof s<"u"?"".concat(r).concat(r?"&":"").concat(globalThis.encodeURIComponent(n),"=").concat(globalThis.encodeURIComponent("".concat(i))):r},""),webRequest=async e=>{var d;const{url:r,method:n="GET",headers:s={},params:i={},data:o={},...c}=e,u=urlencoded(i);let l=JSON.stringify(o);return(d=s["Content-Type"])!=null&&d.includes("application/x-www-form-urlencoded")&&(l=urlencoded(o)),(await globalThis.fetch(u?"".concat(r,"?").concat(u):r,{method:n,headers:s,body:n==="GET"?void 0:l,...c})).json()};var B,K,z,Q;class HttpDataSource extends DataSource{constructor(n){const{options:s}=n.schema;super(n);$(this,"isLoading",!1);$(this,"error");$(this,"httpOptions");N(this,B);N(this,K,[]);N(this,z,[]);N(this,Q,"http");this.httpOptions=s,typeof n.request=="function"?q(this,B,n.request):typeof globalThis.fetch=="function"&&q(this,B,webRequest),this.methods.forEach(i=>{typeof i.content=="function"&&(i.timing==="beforeRequest"&&L(this,K).push(i.content),i.timing==="afterRequest"&&L(this,z).push(i.content))})}get type(){return L(this,Q)}async init(){this.schema.autoFetch&&await this.request(),super.init()}async request(n={}){var f,d;this.isLoading=!0;const{url:s,params:i,data:o,headers:c,...u}=this.httpOptions;let l={url:typeof s=="function"?s({app:this.app,dataSource:this}):s,params:typeof i=="function"?i({app:this.app,dataSource:this}):i,data:typeof o=="function"?o({app:this.app,dataSource:this}):o,headers:typeof c=="function"?c({app:this.app,dataSource:this}):c,...u,...n};try{for(const h of L(this,K))await h({options:l,params:{},dataSource:this,app:this.app});if(typeof this.schema.beforeRequest=="function"&&(l=await this.schema.beforeRequest(l,{app:this.app,dataSource:this})),this.mockData)this.setData(this.mockData);else{let h=await((f=L(this,B))==null?void 0:f.call(this,l));for(const y of L(this,z))await y({res:h,options:l,params:{},dataSource:this,app:this.app});if(typeof this.schema.afterResponse=="function"&&(h=await this.schema.afterResponse(h,{app:this.app,dataSource:this,options:l})),(d=this.schema.responseOptions)!=null&&d.dataPath){const y=getValueByKeyPath(this.schema.responseOptions.dataPath,h);this.setData(y)}else this.setData(h)}this.error=void 0}catch(h){this.error={msg:h.message},this.emit("error",h)}this.isLoading=!1}get(n){return this.request({...n,method:"GET"})}post(n){return this.request({...n,method:"POST"})}}B=new WeakMap,K=new WeakMap,z=new WeakMap,Q=new WeakMap;const cache=new Map,getDeps=(e,r,n)=>{let s;if(n){const l=[];r.forEach(f=>{traverseNode(f,d=>{l.push(d.id)})}),s="".concat(e.id,":").concat(l.join(":"))}else s="".concat(e.id,":").concat(r.map(l=>l.id).join(":"));if(cache.has(s))return cache.get(s);const i=new Watcher;i.addTarget(new Target({id:e.id,type:"data-source",isTarget:(l,f)=>"".concat(l).includes(DSL_NODE_KEY_COPY_PREFIX)?!1:isDataSourceTarget(e,l,f,!0)})),i.addTarget(new Target({id:e.id,type:"cond",isTarget:(l,f)=>isDataSourceCondTarget(e,l,f,!0)})),i.collect(r,{},!0);const{deps:o}=i.getTarget(e.id,"data-source"),{deps:c}=i.getTarget(e.id,"cond"),u={deps:o,condDeps:c};return cache.set(s,u),u},compiledCondition=(e,r)=>{let n=!0;for(const{op:s,value:i,range:o,field:c}of e){const[u,...l]=c,f=r[u];if(!f||!l.length)break;try{const d=getValueByKeyPath(l.join("."),f);if(!compiledCond(s,d,i,o)){n=!1;break}}catch(d){console.warn(d)}}return n},compliedConditions=(e,r)=>{if(!e[C]||!Array.isArray(e[C])||!e[C].length)return!0;for(const{cond:n}of e[C])if(n&&compiledCondition(n,r))return!0;return!1},updateNode=(e,r)=>{var n;if(isPage(e)||isPageFragment(e)){const s=(n=r.items)==null?void 0:n.findIndex(i=>i.id===e.id);r.items.splice(s,1,e)}else replaceChildNode(e,r.items)},createIteratorContentData=(e,r,n=[],s={})=>{const i={...s,[r]:{}};let o=cloneDeep(s[r]),c=i[r];return n.forEach((u,l)=>{if(Object.assign(c,o),l===n.length-1){c[u]=e;return}Array.isArray(o[u])&&(o[u]={},c[u]={}),o=o[u],c=c[u]}),i},compliedDataSourceField=(e,r)=>{const[n,...s]=e,i=n.indexOf(DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX);if(i>-1){const o=n.substring(i+DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX.length),c=r[o];if(!c)return e;try{return getValueByKeyPath(s.join("."),c)}catch(u){return e}}return e},template=(e,r)=>e.replaceAll(dataSourceTemplateRegExp,(n,s)=>{try{return getValueByKeyPath(s,r)}catch(i){return n}}),compiledNodeField=(e,r)=>typeof e=="string"?template(e,r):e!=null&&e.isBindDataSource&&e.dataSourceId?r[e.dataSourceId]:e!=null&&e.isBindDataSourceField&&e.dataSourceId&&typeof e.template=="string"?template(e.template,r[e.dataSourceId]):Array.isArray(e)&&typeof e[0]=="string"?compliedDataSourceField(e,r):e,compliedIteratorItem=({compile:e,dsId:r,item:n,deps:s,condDeps:i,inEditor:o,ctxData:c})=>{var d,h;const{items:u,...l}=n,f=cloneDeep(l);return(d=i[l.id])!=null&&d.keys.length&&!o&&(f.condResult=compliedConditions(l,c)),Array.isArray(u)&&u.length?f.items=u.map(y=>compliedIteratorItem({compile:e,dsId:r,item:y,deps:s,condDeps:i,inEditor:o,ctxData:c})):u&&(f.items=u),(h=s[f.id])!=null&&h.keys.length?compiledNode(e,f,{[r]:s},r):f},registerDataSourceOnDemand=async(e,r)=>{const{dataSourceMethodsDeps:n={},dataSourceCondDeps:s={},dataSourceDeps:i={},dataSources:o=[]}=e,c={};o.forEach(f=>{let d=s[f.id]||{};Object.keys(d).length||(d=i[f.id]||{}),Object.keys(d).length||(d=n[f.id]||{}),Object.keys(d).length&&r[f.type]&&(c[f.type]=r[f.type])});const u=await Promise.all(Object.values(c).map(f=>f())),l={};return u.forEach((f,d)=>{const h=Object.keys(c)[d];l[h]=f.default}),l},F=class F extends EventEmitter$1{constructor({app:n,useMock:s,initialData:i}){var c,u;super();$(this,"app");$(this,"dataSourceMap",new Map);$(this,"data",{});$(this,"useMock",!1);this.app=n,this.useMock=s,i&&(this.data=i),(u=(c=n.dsl)==null?void 0:c.dataSources)==null||u.forEach(l=>{this.addDataSource(l)});const o=Array.from(this.dataSourceMap);typeof Promise.allSettled=="function"?Promise.allSettled(o.map(([,l])=>this.init(l))).then(l=>{const f={},d={};l.forEach((h,y)=>{const b=o[y][0];h.status==="fulfilled"?this.data[b]?f[b]=this.data[b]:delete f[b]:h.status==="rejected"&&(delete f[b],d[b]=h.reason)}),this.emit("init",f,d)}):Promise.all(o.map(([,l])=>this.init(l))).then(()=>{this.emit("init",this.data)}).catch(()=>{this.emit("init",this.data)})}static register(n,s){F.dataSourceClassMap.set(n,s)}static getDataSourceClass(n){return F.dataSourceClassMap.get(n)}static registerObservedData(n){F.ObservedDataClass=n}async init(n){var s;if(!n.isInit&&!(this.app.jsEngine&&((s=n.schema.disabledInitInJsEngine)!=null&&s.includes(this.app.jsEngine)))){for(const i of n.methods){if(typeof i.content!="function")return;i.timing==="beforeInit"&&await i.content({params:{},dataSource:n,app:this.app})}await n.init();for(const i of n.methods){if(typeof i.content!="function")return;i.timing==="afterInit"&&await i.content({params:{},dataSource:n,app:this.app})}}}get(n){return this.dataSourceMap.get(n)}async addDataSource(n){if(!n)return;const s=F.dataSourceClassMap.get(n.type)||DataSource,i=new s({app:this.app,schema:n,request:this.app.request,useMock:this.useMock,initialData:this.data[n.id],ObservedDataClass:F.ObservedDataClass});this.dataSourceMap.set(n.id,i),this.data[i.id]=i.data,i.on("change",o=>{this.setData(i,o)})}setData(n,s){this.data[n.id]=n.data,this.emit("change",n.id,s)}removeDataSource(n){var s;(s=this.get(n))==null||s.destroy(),delete this.data[n],this.dataSourceMap.delete(n)}updateSchema(n){n.forEach(s=>{if(!this.get(s.id))return;this.removeDataSource(s.id),this.addDataSource(s);const o=this.get(s.id);o&&this.init(o)})}compiledNode({items:n,...s},i,o=!1){var u;const c=cloneDeep(s);return n&&(c.items=Array.isArray(n)&&o?n.map(l=>this.compiledNode(l,i,o)):n),s.condResult===!1||s.visible===!1?c:compiledNode(l=>compiledNodeField(l,this.data),c,((u=this.app.dsl)==null?void 0:u.dataSourceDeps)||{},i)}compliedConds(n){return compliedConditions(n,this.data)}compliedIteratorItemConds(n,s,i=[]){const[o,...c]=i,u=this.get(o);if(!u)return!0;const l=createIteratorContentData(n,u.id,c,this.data);return compliedConditions(s,l)}compliedIteratorItems(n,s,i=[]){const[o,...c]=i,u=this.get(o);if(!u)return s;const l=this.app.platform==="editor",f=createIteratorContentData(n,u.id,c,this.data),{deps:d={},condDeps:h={}}=getDeps(u.schema,s,l);return!Object.keys(d).length&&!Object.keys(h).length?s:s.map(y=>compliedIteratorItem({compile:b=>compiledNodeField(b,f),dsId:u.id,item:y,deps:d,condDeps:h,inEditor:l,ctxData:f}))}destroy(){this.removeAllListeners(),this.data={},this.dataSourceMap.forEach(n=>{n.destroy()}),this.dataSourceMap.clear()}onDataChange(n,s,i){var o;return(o=this.get(n))==null?void 0:o.onDataChange(s,i)}offDataChange(n,s,i){var o;return(o=this.get(n))==null?void 0:o.offDataChange(s,i)}};$(F,"dataSourceClassMap",new Map),$(F,"ObservedDataClass",SimpleObservedData);let DataSourceManager=F;DataSourceManager.register("http",HttpDataSource);const createDataSourceManager=(e,r,n)=>{const{dsl:s,platform:i}=e;if(!(s!=null&&s.dataSources))return;const o=new DataSourceManager({app:e,useMock:r,initialData:n});return s.dataSources&&s.dataSourceCondDeps&&i!=="editor"&&getNodes(getDepNodeIds(s.dataSourceCondDeps),s.items).forEach(c=>{c.condResult=o.compliedConds(c),updateNode(c,s)}),s.dataSources&&s.dataSourceDeps&&getNodes(getDepNodeIds(s.dataSourceDeps),s.items).forEach(c=>{updateNode(o.compiledNode(c),s)}),e.jsEngine!=="nodejs"&&o.on("change",(c,u)=>{var y,b,v;const l=((y=s.dataSourceDeps)==null?void 0:y[c])||{},f=((b=s.dataSourceCondDeps)==null?void 0:b[c])||{},d=union([...Object.keys(f),...Object.keys(l)]),h=(v=e.page)!=null&&v.data&&e.platform!=="editor"?[e.page.data]:s.items;o.emit("update-data",getNodes(d,h).map(j=>{var I;e.platform!=="editor"&&(j.condResult=o.compliedConds(j));const w=o.compiledNode(j);if(typeof((I=e.page)==null?void 0:I.setData)=="function")if(isPage(w))e.page.setData(w);else{const P=e.page.getNode(j.id);P==null||P.setData(w)}return w}),c,u)}),o},ignoreFirstCall=e=>{let r=0;return(...n)=>{if(r===0){r+=1;return}return e(...n)}};class DeepObservedData extends ObservedData{constructor(n){super();$(this,"state");$(this,"subscribers",new Map);$(this,"update",(n,s)=>{var i;(i=this.state)==null||i.update(s!=null?s:"",n)});$(this,"on",(n,s)=>{var c;const i=this.state.subscribe(n,ignoreFirstCall(s)),o=(c=this.subscribers.get(n))!=null?c:new Map;o.set(s,i),this.subscribers.set(n,o)});$(this,"off",(n,s)=>{var o;const i=this.subscribers.get(n);i&&((o=i.get(s))==null||o(),i.delete(s))});$(this,"getData",n=>{var s;return this.state?(s=this.state)==null?void 0:s.get(n):{}});$(this,"destroy",()=>{this.subscribers.forEach(n=>{n.forEach(s=>s())})});this.state=new DeepState(n)}}var a=(e=>(e.CONTAINER="container",e.PAGE="page",e.ROOT="app",e.PAGE_FRAGMENT="page-fragment",e))(a||{});const C="displayConds";var E=(e=>(e.COMP="comp",e.CODE="code",e.DATA_SOURCE="data-source",e))(E||{}),O=(e=>(e.CODE="code",e))(O||{}),t=(e=>(e.CODE="code",e.DATA_SOURCE_METHOD="data-source-method",e))(t||{});const dslDomRelateConfig={getIdFromEl:e=>{var r;return(r=e==null?void 0:e.dataset)==null?void 0:r.tmagicId},getElById:(e,r)=>e==null?void 0:e.querySelector('[data-tmagic-id="'.concat(r,'"]')),setIdToEl:(e,r)=>{e.dataset.tmagicId="".concat(r)}},getIdFromEl=()=>dslDomRelateConfig.getIdFromEl,toLine=(e="")=>e.replace(/\B([A-Z])/g,"-$1").toLowerCase(),getNodePath=(e,r=[])=>{const n=[],s=function(i,o){if(!Array.isArray(o))return null;for(let c=0,u=o.length;c<u;c++){const l=o[c];if(n.push(l),"".concat(l.id)==="".concat(i))return l;if(l.items){const f=s(i,l.items);if(f)return f}n.pop()}return null};return s(e,r),n},filterXSS=e=>e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),getUrlParam=(e,r)=>{const n=location.href,s=new RegExp("[?&#]".concat(e,"=([^&#]+)"),"gi"),i=n.match(s);let o;return i&&i.length>0?(o=i[i.length-1].split("="),o&&o.length>1?filterXSS(o[1]):""):""},isObject=e=>Object.prototype.toString.call(e)==="[object Object]",isPage=e=>{var r;return e?((r=e.type)==null?void 0:r.toLowerCase())===a.PAGE:!1},isPageFragment=e=>{var r;return e?((r=e.type)==null?void 0:r.toLowerCase())===a.PAGE_FRAGMENT:!1},isNumber=e=>/^(-?\d+)(\.\d+)?$/.test(e),getKeysArray=e=>"".concat(e).replaceAll(/\[(\d+)\]/g,".$1").split("."),getValueByKeyPath=(e="",r={})=>(Array.isArray(e)?e:getKeysArray(e)).reduce((s,i)=>{if(isObject(s)||Array.isArray(s)&&/^\d*$/.test("".concat(i)))return s[i];throw new Error("".concat(r,"").concat(e))},r),setValueByKeyPath=(e,r,n={})=>set(n,e,r),getNodes=(e,r=[])=>{const n=[],s=function(i,o){if(Array.isArray(o))for(let c=0,u=o.length;c<u;c++){const l=o[c],f=i.findIndex(d=>"".concat(d)==="".concat(l.id));f>-1&&(i.slice(f,1),n.push(l)),l.items&&s(i,l.items)}};return s(e,r),n},getDepKeys=(e={},r)=>Array.from(Object.values(e).reduce((n,s)=>{var i;return(((i=s[r])==null?void 0:i.keys)||[]).forEach(o=>n.add(o)),n},new Set)),getDepNodeIds=(e={})=>Array.from(Object.values(e).reduce((r,n)=>(Object.keys(n).forEach(s=>{r.add(s)}),r),new Set)),replaceChildNode=(e,r,n)=>{var u;const s=getNodePath(e.id,r),i=s.pop();let o=s.pop();if(!i)throw new Error("");if(!o)throw new Error("");const c=(u=o.items)==null?void 0:u.findIndex(l=>l.id===i.id);o.items.splice(c,1,e)},DSL_NODE_KEY_COPY_PREFIX="__tmagic__",IS_DSL_NODE_KEY="__tmagic__dslNode",compiledNode=(e,r,n={},s)=>{let i=[];if(!s)i=getDepKeys(n,r.id);else{const o=n[s];i=(o==null?void 0:o[r.id].keys)||[]}return i.forEach(o=>{const c=getKeysArray(o),u=c.map((d,h)=>h<c.length-1?d:"".concat(DSL_NODE_KEY_COPY_PREFIX).concat(d));let l=getValueByKeyPath(u,r);if(typeof l>"u")try{const d=getValueByKeyPath(o,r);setValueByKeyPath(u.join("."),d,r),l=d}catch(d){console.warn(d);return}let f;try{f=e(l)}catch(d){console.error(d),f=""}setValueByKeyPath(o,f,r)}),r},compiledCond=(e,r,n,s=[])=>{var i,o;switch(typeof r=="string"&&typeof n>"u"&&(n=""),e){case"is":return r===n;case"not":return r!==n;case"=":return r===n;case"!=":return r!==n;case">":return r>n;case">=":return r>=n;case"<":return r<n;case"<=":return r<=n;case"between":return s.length>1&&r>=s[0]&&r<=s[1];case"not_between":return s.length<2||r<s[0]||r>s[1];case"include":return(i=r==null?void 0:r.includes)==null?void 0:i.call(r,n);case"not_include":return typeof r>"u"||!((o=r.includes)!=null&&o.call(r,n))}return!1},getDefaultValueFromFields=e=>{const r={},n={string:void 0,object:{},array:[],boolean:void 0,number:void 0,null:null,any:void 0};return e.forEach(s=>{if(typeof s.defaultValue<"u"){if(s.type==="array"&&!Array.isArray(s.defaultValue)){r[s.name]=n.array;return}if(s.type==="object"&&!isObject(s.defaultValue)){if(typeof s.defaultValue=="string"){try{r[s.name]=JSON.parse(s.defaultValue)}catch(i){r[s.name]=n.object}return}r[s.name]=n.object;return}r[s.name]=cloneDeep$1(s.defaultValue);return}if(s.type==="object"){r[s.name]=s.fields?getDefaultValueFromFields(s.fields):n.object;return}if(s.type){r[s.name]=n[s.type];return}r[s.name]=void 0}),r},DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX="ds-field::",DATA_SOURCE_FIELDS_CHANGE_EVENT_PREFIX="ds-field-changed",addParamToUrl=(e,r=globalThis,n=!0)=>{const s=new URL(r.location.href),{searchParams:i}=s;for(const[c,u]of Object.entries(e))i.set(c,u);const o=s.toString();n?r.location.href=o:r.history.pushState({},"",s)},dataSourceTemplateRegExp=/\$\{([\s\S]+?)\}/g,isDslNode=e=>typeof e[IS_DSL_NODE_KEY]>"u"||e[IS_DSL_NODE_KEY]===!0,traverseNode=(e,r,n=[])=>{r(e,n),Array.isArray(e.items)&&e.items.length&&(n.push(e),e.items.forEach(s=>{traverseNode(s,r,[...n])}))};var DepTargetType=(e=>(e.DEFAULT="default",e.CODE_BLOCK="code-block",e.DATA_SOURCE="data-source",e.DATA_SOURCE_METHOD="data-source-method",e.DATA_SOURCE_COND="data-source-cond",e))(DepTargetType||{});class Target{constructor(r){$(this,"isTarget");$(this,"id");$(this,"name");$(this,"type",DepTargetType.DEFAULT);$(this,"deps",{});$(this,"isCollectByDefault");var n;this.isTarget=r.isTarget,this.id=r.id,this.name=r.name,this.isCollectByDefault=(n=r.isCollectByDefault)!=null?n:!0,r.type&&(this.type=r.type),r.initialDeps&&(this.deps=r.initialDeps)}updateDep({id:r,name:n,key:s,data:i}){const o=this.deps[r]||{name:n,keys:[]};o.name=n,o.data=i,this.deps[r]=o,o.keys.indexOf(s)===-1&&o.keys.push(s)}removeDep(r,n){if(typeof r>"u"){Object.keys(this.deps).forEach(i=>{delete this.deps[i]});return}const s=this.deps[r];if(s)if(n){const i=s.keys.indexOf(n);s.keys.splice(i,1),s.keys.length===0&&delete this.deps[r]}else delete this.deps[r]}hasDep(r,n){const s=this.deps[r];return!!(s!=null&&s.keys.find(i=>i===n))}destroy(){this.deps={}}}const isIncludeArrayField=(e,r)=>{let n=r;return e.some((s,i)=>{const o=n.find(({name:c})=>c===s);return n=(o==null?void 0:o.fields)||[],o&&o.type==="array"&&/^(?!\d+$).*$/.test("".concat(e[i+1]))&&i<e.length-1})},isDataSourceTemplate=(e,r,n=!1)=>{const s=e.match(dataSourceTemplateRegExp)||[];if(s.length<=0)return!1;const i=[],o=[];return s.forEach(c=>{const u=c.substring(2,c.length-1),l=getKeysArray(u),f=l.shift();!f||f!==r.id||(isIncludeArrayField(l,r.fields)?i.push(c):o.push(c))}),n?i.length>0:o.length>0},isSpecificDataSourceTemplate=(e,r)=>(e==null?void 0:e.isBindDataSourceField)&&e.dataSourceId&&e.dataSourceId===r&&typeof e.template=="string",isUseDataSourceField=(e,r)=>{if(!Array.isArray(e)||typeof e[0]!="string")return!1;const[n]=e,s=n.indexOf(DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX);return s===-1?!1:n.substring(s+DATA_SOURCE_FIELDS_SELECT_VALUE_PREFIX.length)===r},isDataSourceTarget=(e,r,n,s=!1)=>{if("".concat(r).startsWith(C))return!1;if(typeof n=="string")return isDataSourceTemplate(n,e,s);if(isObject(n)&&(n!=null&&n.isBindDataSource)&&n.dataSourceId&&n.dataSourceId===e.id||isSpecificDataSourceTemplate(n,e.id))return!0;if(isUseDataSourceField(n,e.id)){const[,...i]=n,o=isIncludeArrayField(i,e.fields);return s?o:!o}return!1},isDataSourceCondTarget=(e,r,n,s=!1)=>{var c;if(!Array.isArray(n)||!e)return!1;const[i,...o]=n;if(i!==e.id||!"".concat(r).startsWith(C))return!1;if((c=e.fields)!=null&&c.find(u=>u.name===o[0])){const u=isIncludeArrayField(o,e.fields);return s?u:!u}return!1},traverseTarget=(e,r,n)=>{Object.values(e).forEach(s=>{Object.values(s).forEach(i=>{n&&i.type!==n||r(i)})})};class Watcher{constructor(r){$(this,"targetsList",{});$(this,"childrenProp","items");$(this,"idProp","id");$(this,"nameProp","name");r!=null&&r.initialTargets&&(this.targetsList=r.initialTargets),r!=null&&r.childrenProp&&(this.childrenProp=r.childrenProp)}getTargetsList(){return this.targetsList}getTargets(r=DepTargetType.DEFAULT){return this.targetsList[r]||{}}addTarget(r){const n=this.getTargets(r.type)||{};this.targetsList[r.type]=n,n[r.id]=r}getTarget(r,n=DepTargetType.DEFAULT){return this.getTargets(n)[r]}hasTarget(r,n=DepTargetType.DEFAULT){return!!this.getTarget(r,n)}hasSpecifiedTypeTarget(r=DepTargetType.DEFAULT){return Object.keys(this.getTargets(r)).length>0}removeTarget(r,n=DepTargetType.DEFAULT){const s=this.getTargets(n);s[r]&&(s[r].destroy(),delete s[r])}removeTargets(r=DepTargetType.DEFAULT){const n=this.targetsList[r];if(n){for(const s of Object.values(n))s.destroy();delete this.targetsList[r]}}clearTargets(){Object.keys(this.targetsList).forEach(r=>{delete this.targetsList[r]})}collect(r,n={},s=!1,i){this.collectByCallback(r,i,({node:o,target:c})=>{this.removeTargetDep(c,o),this.collectItem(o,c,n,s)})}collectByCallback(r,n,s){traverseTarget(this.targetsList,i=>{!n&&!i.isCollectByDefault||r.forEach(o=>{s({node:o,target:i})})},n)}clear(r,n){let{targetsList:s}=this;n&&(s={[n]:this.getTargets(n)});const i=[];traverseTarget(s,o=>{r?r.forEach(c=>{o.removeDep(c[this.idProp]),Array.isArray(c[this.childrenProp])&&c[this.childrenProp].length&&!i.includes(c[this.idProp])&&(i.push(c[this.idProp]),this.clear(c[this.childrenProp]))}):o.removeDep()})}clearByType(r,n){this.clear(n,r)}collectItem(r,n,s={},i=!1){const o=(c,u="")=>{const l=(f,d)=>{const h=f===this.childrenProp,y=u?"".concat(u,".").concat(f):f;n.isTarget(y,d)?n.updateDep({id:r[this.idProp],name:"".concat(r[this.nameProp]||r[this.idProp]),data:s,key:y}):!h&&Array.isArray(d)?d.forEach((b,v)=>{isObject(b)&&o(b,"".concat(y,"[").concat(v,"]"))}):isObject(d)&&o(d,y),h&&i&&Array.isArray(d)&&d.forEach(b=>{this.collectItem(b,n,s,i)})};Object.entries(c).forEach(([f,d])=>{typeof d>"u"||d===""||l(f,d)})};o(r)}removeTargetDep(r,n,s){r.removeDep(n[this.idProp],s),typeof s>"u"&&Array.isArray(n[this.childrenProp])&&n[this.childrenProp].length&&n[this.childrenProp].forEach(i=>{this.removeTargetDep(r,i,s)})}}class Env{constructor(r=globalThis.navigator.userAgent,n={}){$(this,"isIos",!1);$(this,"isIphone",!1);$(this,"isIpad",!1);$(this,"isAndroid",!1);$(this,"isAndroidPad",!1);$(this,"isMac",!1);$(this,"isWin",!1);$(this,"isMqq",!1);$(this,"isWechat",!1);$(this,"isWeb",!1);$(this,"isOpenHarmony",!1);this.isIphone=r.indexOf("iPhone")>=0,this.isIpad=/(iPad).*OS\s([\d_]+)/.test(r),this.isIos=this.isIphone||this.isIpad,this.isAndroid=r.indexOf("Android")>=0,this.isAndroidPad=this.isAndroid&&r.indexOf("Mobile")<0,this.isMac=r.indexOf("Macintosh")>=0,this.isWin=r.indexOf("Windows")>=0,this.isMqq=/QQ\/([\d.]+)/.test(r),this.isWechat=r.indexOf("MicroMessenger")>=0&&r.indexOf("wxwork")<0,this.isOpenHarmony=r.includes("OpenHarmony"),this.isWeb=!this.isIos&&!this.isAndroid&&!this.isOpenHarmony&&!/(WebOS|BlackBerry)/.test(r),Object.entries(n).forEach(([s,i])=>{this[s]=i})}}class FlowState{constructor(){$(this,"isAbort");this.isAbort=!1}abort(){this.isAbort=!0}reset(){this.isAbort=!1}}const style2Obj=e=>{if(typeof e!="string")return e;const r={};return e.split(";").forEach(n=>{if(!n)return;const s=n.split(":");let i=s.shift(),o=s.join(":");i&&(i=i.replace(/^\s*/,"").replace(/\s*$/,""),o=o.replace(/^\s*/,"").replace(/\s*$/,""),i=i.split("-").map((c,u)=>u>0?"".concat(c[0].toUpperCase()).concat(c.substr(1)):c).join(""),r[i]=o)}),r},fillBackgroundImage=e=>e&&!/^url/.test(e)&&!/^linear-gradient/.test(e)?"url(".concat(e,")"):e,getTransform=(e,r)=>{if(!e)return[];const n=Object.entries(e).map(([i,o])=>o.trim()?(i==="rotate"&&isNumber(o)&&(o="".concat(o,"deg")),r!=="hippy"?"".concat(i,"(").concat(o,")"):{[i]:o}):"");if(r==="hippy")return n;const s=n.join(" ");return s.trim()?s:"none"},transformStyle=(e,r)=>{if(!e)return{};let n={};const s={};typeof e=="string"?n=style2Obj(e):n={...e};const i=r==="hippy",o=["zIndex","opacity","fontWeight"];return Object.entries(n).forEach(([c,u])=>{c==="scale"&&!s.transform&&i?s.transform=[{scale:u}]:c==="backgroundImage"&&!i?u&&(s[c]=fillBackgroundImage(u)):c==="transform"&&typeof u!="string"?s[c]=getTransform(u,r):!o.includes(c)&&u&&/^[-]?[0-9]*[.]?[0-9]*$/.test(u)?s[c]=i?u:"".concat(u/100,"rem"):s[c]=u}),s},COMMON_EVENT_PREFIX="magic:common:events:",COMMON_METHOD_PREFIX="magic:common:actions:",CommonMethod={SHOW:"show",HIDE:"hide",SCROLL_TO_VIEW:"scrollIntoView",SCROLL_TO_TOP:"scrollToTop"},isCommonMethod=e=>e.startsWith(COMMON_METHOD_PREFIX),triggerCommonMethod=(e,r)=>{var s;const{instance:n}=r;if(n)switch(e.replace(COMMON_METHOD_PREFIX,"")){case CommonMethod.SHOW:n.show();break;case CommonMethod.HIDE:n.hide();break;case CommonMethod.SCROLL_TO_VIEW:(s=n.$el)==null||s.scrollIntoView({behavior:"smooth"});break;case CommonMethod.SCROLL_TO_TOP:window.scrollTo({top:0,behavior:"smooth"});break}},getCommonEventName=e=>e.startsWith(COMMON_EVENT_PREFIX)?e:"".concat(COMMON_EVENT_PREFIX).concat(e),getDirectComponent=(e,r)=>{var i,o;if(!e)return;const n=getIdFromEl()(e);return n?r.getNode(n,(i=e.dataset.tmagicIteratorContainerId)==null?void 0:i.split(","),(o=e.dataset.tmagicIteratorIndex)==null?void 0:o.split(",").map(c=>globalThis.parseInt(c,10))):getDirectComponent(e.parentElement,r)};class EventHelper extends eventsExports.EventEmitter{constructor({app:n}){super();$(this,"app");$(this,"nodeEventList",new Map);$(this,"dataSourceEventList",new Map);$(this,"commonClickEventHandler",n=>{if(!n.target)return;const s=getDirectComponent(n.target,this.app),i="".concat(getCommonEventName("click"),"_").concat(s==null?void 0:s.data.id);s!=null&&s.eventKeys.has(i)&&this.emit(s.eventKeys.get(i),s)});this.app=n,globalThis.document.body.addEventListener("click",this.commonClickEventHandler)}destroy(){this.removeNodeEvents(),this.removeAllListeners(),globalThis.document.body.removeEventListener("click",this.commonClickEventHandler)}bindNodeEvents(n){var s;(s=n.events)==null||s.forEach((i,o)=>{let c="".concat(i.name,"_").concat(n.data.id);const u=i.name.split(".");u.length>1&&(c="".concat(u[1],"_").concat(u[0]));let l=Symbol(c);n.eventKeys.has(c)?l=n.eventKeys.get(c):n.eventKeys.set(c,l);const f=(d,...h)=>{this.eventHandler(o,n,h)};this.nodeEventList.set(f,l),this.on(l,f)})}removeNodeEvents(){Array.from(this.nodeEventList.keys()).forEach(n=>{const s=this.nodeEventList.get(n);s&&this.off(s,n)}),this.nodeEventList.clear()}bindDataSourceEvents(n){this.removeDataSourceEvents(n),n.forEach(s=>{var o;const i=(o=this.dataSourceEventList.get(s.id))!=null?o:new Map;(s.schema.events||[]).forEach(c=>{var d;const[u,...l]=((d=c.name)==null?void 0:d.split("."))||[];if(!u)return;const f=(...h)=>{this.eventHandler(c,s,h)};i.set(c.name,f),u===DATA_SOURCE_FIELDS_CHANGE_EVENT_PREFIX?s==null||s.onDataChange(l.join("."),f):s.on(u,f)}),this.dataSourceEventList.set(s.id,i)})}removeDataSourceEvents(n){this.dataSourceEventList.size&&(n.forEach(s=>{const i=this.dataSourceEventList.get(s.id);i&&Array.from(i.keys()).forEach(o=>{const[c,...u]=o.split(".");c===DATA_SOURCE_FIELDS_CHANGE_EVENT_PREFIX?s.offDataChange(u.join("."),i.get(o)):s.off(c,i.get(o))})}),this.dataSourceEventList.clear())}async eventHandler(n,s,i){const o=typeof n=="number"?s.events[n]:n;if(has(o,"actions")){const c=new FlowState,{actions:u}=o;for(let l=0;l<u.length&&!(c!=null&&c.isAbort);l++)if(typeof n=="number"){const f=s.events[n].actions[l];this.actionHandler(f,s,i,c)}else this.actionHandler(u[l],s,i,c);c.reset()}else await this.compActionHandler(o,s,i)}async actionHandler(n,s,i,o){if(n.actionType===E.COMP){const c=n;await this.compActionHandler(c,s,i)}else if(n.actionType===E.CODE){const c=n;await this.app.runCode(c.codeId,c.params||{},i,o)}else if(n.actionType===E.DATA_SOURCE){const c=n,[u,l]=c.dataSourceMethod;await this.app.runDataSourceMethod(u,l,c.params||{},i,o)}}async compActionHandler(n,s,i){if(!this.app.page)throw new Error("");let{method:o,to:c}=n;Array.isArray(o)&&([c,o]=o);const u=this.app.getNode(c);if(!u)throw"ID".concat(c,"");if(isCommonMethod(o))return triggerCommonMethod(o,u);u.instance?typeof u.instance[o]=="function"&&await u.instance[o](s,...i):u.addEventToQueue({method:o,fromCpt:s,args:i})}}class Flexible{constructor(r){$(this,"designWidth",375);$(this,"tid");$(this,"resizeHandler",()=>{clearTimeout(this.tid),this.tid=setTimeout(()=>{this.refreshRem(),this.tid=void 0},300)});$(this,"pageshowHandler",r=>{r.persisted&&this.resizeHandler()});globalThis.document.readyState==="complete"?this.setBodyFontSize():globalThis.document.addEventListener("DOMContentLoaded",this.setBodyFontSize,!1),globalThis.addEventListener("resize",this.resizeHandler,!1),globalThis.addEventListener("pageshow",this.pageshowHandler,!1),typeof(r==null?void 0:r.designWidth)<"u"&&this.setDesignWidth(r.designWidth)}destroy(){globalThis.document.removeEventListener("DOMContentLoaded",this.setBodyFontSize,!1),globalThis.removeEventListener("resize",this.resizeHandler,!1),globalThis.removeEventListener("pageshow",this.pageshowHandler,!1)}setDesignWidth(r){this.designWidth=r,this.refreshRem()}setBodyFontSize(){globalThis.document.body.style.fontSize=".12rem"}refreshRem(){const{width:r}=document.documentElement.getBoundingClientRect(),n=r/(this.designWidth/100);globalThis.document.documentElement.style.fontSize="".concat(n,"px"),globalThis.document.documentElement.style.fontSize="".concat(this.correctRem(n),"px")}correctRem(r){const{document:n}=globalThis,s=n.createElement("div");s.style.cssText="width:1rem;height:0;overflow:hidden;position:absolute;z-index:-1;visibility:hidden;",n.documentElement.appendChild(s);const i=s.offsetWidth;return n.documentElement.removeChild(s),Math.abs(i-r)>1?r**2/i:r}}class Store{constructor(){$(this,"data",{})}set(r,n){this.data[r]=n}get(r){return this.data[r]}}class Node extends eventsExports.EventEmitter{constructor(n){super();$(this,"data");$(this,"style");$(this,"events",[]);$(this,"instance");$(this,"page");$(this,"parent");$(this,"app");$(this,"store",new Store);$(this,"eventKeys",new Map);$(this,"eventQueue",[]);this.page=n.page,this.parent=n.parent,this.app=n.app,this.setData(n.config),this.listenLifeSafe()}setData(n){this.data=n;const{events:s,style:i}=n;this.events=s||[],this.style=i||{},this.emit("update-data",n)}addEventToQueue(n){this.eventQueue.push(n)}async runHookCode(n,s){var o,c,u;if(typeof this.data[n]=="function"){await this.data[n](this);return}const i=this.data[n];if((i==null?void 0:i.hookType)===O.CODE)for(const l of i.hookData){const{codeType:f=t.CODE,codeId:d,params:h={}}=l;let y;const b={app:this.app,params:s||h};if(f===t.CODE&&typeof d=="string"&&((o=this.app.codeDsl)!=null&&o[d]))y=this.app.codeDsl[d].content;else if(f===t.DATA_SOURCE_METHOD&&Array.isArray(d)&&d.length>1){const v=(c=this.app.dataSourceManager)==null?void 0:c.get(d[0]);y=(u=v==null?void 0:v.methods.find(j=>j.name===d[1]))==null?void 0:u.content,b.dataSource=v}y&&typeof y=="function"&&await y(b)}}destroy(){this.removeAllListeners()}listenLifeSafe(){this.once("created",async n=>{this.once("destroy",()=>{this.instance=null,typeof this.data.destroy=="function"&&this.data.destroy(this),this.listenLifeSafe()}),this.instance=n,await this.runHookCode("created")}),this.once("mounted",async n=>{this.instance=n;for(let s=this.eventQueue.shift();s;s=this.eventQueue.shift())typeof n[s.method]=="function"&&await n[s.method](s.fromCpt,...s.args);await this.runHookCode("mounted")})}}class IteratorContainer extends Node{constructor(){super(...arguments);$(this,"nodes",[])}setData(n){this.resetNodes(),super.setData(n)}resetNodes(){var n;(n=this.nodes)==null||n.forEach(s=>{s.forEach(i=>{i.destroy()})}),this.nodes=[]}initNode(n,s,i){var c,u,l,f,d,h;if(i.has(n.id)&&((c=i.get(n.id))==null||c.destroy()),n.type&&this.app.iteratorContainerType.has(n.type)){const y=new IteratorContainer({config:n,parent:s,page:this.page,app:this.app});i.set(n.id,y),(u=this.app.eventHelper)==null||u.bindNodeEvents(y);return}const o=new Node({config:n,parent:s,page:this.page,app:this.app});if((l=this.app.eventHelper)==null||l.bindNodeEvents(o),i.set(n.id,o),n.type&&this.app.pageFragmentContainerType.has(n.type)&&n.pageFragmentId){const y=(d=(f=this.app.dsl)==null?void 0:f.items)==null?void 0:d.find(b=>b.id===n.pageFragmentId);y&&(n.items=[y])}(h=n.items)==null||h.forEach(y=>{this.initNode(y,o,i)})}setNodes(n,s){const i=this.nodes[s]||new Map;n.forEach(o=>{this.initNode(o,this,i)}),this.nodes[s]=i}getNode(n,s){var i;return(i=this.nodes[s])==null?void 0:i.get(n)}destroy(){super.destroy(),this.resetNodes()}}class Page extends Node{constructor(n){super(n);$(this,"nodes",new Map);this.setNode(n.config.id,this),n.config.items.forEach(s=>{this.initNode(s,this)})}initNode(n,s){var o,c,u;if(n.type&&this.app.iteratorContainerType.has(n.type)){this.setNode(n.id,new IteratorContainer({config:n,parent:s,page:this,app:this.app}));return}const i=new Node({config:n,parent:s,page:this,app:this.app});if(this.setNode(n.id,i),n.type&&this.app.pageFragmentContainerType.has(n.type)&&n.pageFragmentId){const l=(c=(o=this.app.dsl)==null?void 0:o.items)==null?void 0:c.find(f=>f.id===n.pageFragmentId);l&&(n.items=[l])}(u=n.items)==null||u.forEach(l=>{this.initNode(l,i)})}getNode(n,s,i){if(this.nodes.has(n))return this.nodes.get(n);if(Array.isArray(s)&&s.length&&Array.isArray(i)){let o=this.nodes.get(s[0]);for(let c=1,u=s.length;c<u;c++)o=o==null?void 0:o.getNode(s[c],i[c-1]);return o==null?void 0:o.getNode(n,i[i.length-1])}}setNode(n,s){this.nodes.set(n,s)}deleteNode(n){this.nodes.delete(n)}destroy(){super.destroy(),this.nodes.clear()}}class App extends eventsExports.EventEmitter{constructor(n){var s;super();$(this,"env",new Env);$(this,"dsl");$(this,"codeDsl");$(this,"dataSourceManager");$(this,"page");$(this,"useMock",!1);$(this,"platform","mobile");$(this,"jsEngine","browser");$(this,"components",new Map);$(this,"pageFragmentContainerType",new Set(["page-fragment-container"]));$(this,"iteratorContainerType",new Set(["iterator-container"]));$(this,"request");$(this,"transformStyle");$(this,"eventHelper");$(this,"flexible");this.setEnv(n.ua),this.codeDsl=(s=n.config)==null?void 0:s.codeBlocks,n.platform&&(this.platform=n.platform),n.jsEngine&&(this.jsEngine=n.jsEngine),n.pageFragmentContainerType&&(Array.isArray(n.pageFragmentContainerType)?n.pageFragmentContainerType:[n.pageFragmentContainerType]).forEach(o=>{this.pageFragmentContainerType.add(o)}),n.iteratorContainerType&&(Array.isArray(n.iteratorContainerType)?n.iteratorContainerType:[n.iteratorContainerType]).forEach(o=>{this.iteratorContainerType.add(o)}),typeof n.useMock=="boolean"&&(this.useMock=n.useMock),this.jsEngine==="browser"&&!n.disabledFlexible&&(this.flexible=new Flexible({designWidth:n.designWidth})),this.platform!=="editor"&&(this.eventHelper=new EventHelper({app:this})),this.transformStyle=n.transformStyle||(i=>transformStyle(i,this.jsEngine)),n.request&&(this.request=n.request),n.config&&this.setConfig(n.config,n.curPage)}setEnv(n){this.env=new Env(n)}setDesignWidth(n){var s;(s=this.flexible)==null||s.setDesignWidth(n)}setConfig(n,s){var i,o,c;if(this.dsl=n,!s&&n.items.length&&(s=n.items[0].id),this.dataSourceManager&&this.dataSourceManager.destroy(),this.dataSourceManager=createDataSourceManager(this,this.useMock),this.codeDsl=n.codeBlocks,this.setPage(s||((o=(i=this.page)==null?void 0:i.data)==null?void 0:o.id)),this.dataSourceManager){const u=Array.from(this.dataSourceManager.dataSourceMap.values());(c=this.eventHelper)==null||c.bindDataSourceEvents(u)}}setPage(n){var i,o,c,u;const s=(i=this.dsl)==null?void 0:i.items.find(l=>"".concat(l.id)==="".concat(n));if(!s){this.deletePage(),super.emit("page-change");return}s!==((o=this.page)==null?void 0:o.data)&&((c=this.page)==null||c.destroy(),this.page=new Page({config:s,app:this}),(u=this.eventHelper)==null||u.removeNodeEvents(),this.page.nodes.forEach(l=>{var f;(f=this.eventHelper)==null||f.bindNodeEvents(l)}),super.emit("page-change",this.page))}deletePage(){var n,s;(n=this.page)==null||n.destroy(),(s=this.eventHelper)==null||s.removeNodeEvents(),this.page=void 0}getPage(n){if(!n)return this.page;if(this.page&&"".concat(this.page.data.id)==="".concat(n))return this.page}getNode(n,s,i){var o;return(o=this.page)==null?void 0:o.getNode(n,s,i)}registerComponent(n,s){this.components.set(n,s)}unregisterComponent(n){this.components.delete(n)}resolveComponent(n){return this.components.get(n)}emit(n,...s){var c,u;const[i,...o]=s;return this.eventHelper&&i instanceof Node&&((c=i.data)!=null&&c.id)&&i.eventKeys.has("".concat(String(n),"_").concat(i.data.id))?(u=this.eventHelper)==null?void 0:u.emit(i.eventKeys.get("".concat(String(n),"_").concat(i.data.id)),i,...o):super.emit(n,...s)}async runCode(n,s,i,o){var u,l;if(!n||isEmpty(this.codeDsl))return;const c=(l=(u=this.codeDsl)==null?void 0:u[n])==null?void 0:l.content;typeof c=="function"&&await c({app:this,params:s,eventParams:i,flowState:o})}async runDataSourceMethod(n,s,i,o,c){var d;if(!n||!s)return;const u=(d=this.dataSourceManager)==null?void 0:d.get(n);if(!u)return;const f=(u.methods||[]).find(h=>h.name===s);f&&typeof f.content=="function"&&await f.content({app:this,params:i,dataSource:u,eventParams:o,flowState:c})}destroy(){var n,s;this.removeAllListeners(),this.page=void 0,(n=this.flexible)==null||n.destroy(),this.flexible=void 0,(s=this.eventHelper)==null||s.destroy()}}const scriptRel="modulepreload",assetsURL=function(e){return"/tmagic-editor/playground/runtime/vue3/page/"+e},seen={},__vitePreload=function(r,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=assetsURL(l),l in seen)return;seen[l]=!0;const f=l.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(l,'"]').concat(d)))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":scriptRel,f||(h.as="script"),h.crossOrigin="",h.href=l,u&&h.setAttribute("nonce",u),document.head.appendChild(h),f)return new Promise((y,b)=>{h.addEventListener("load",y),h.addEventListener("error",()=>b(new Error("Unable to preload CSS for ".concat(l))))})}))}function o(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return i.then(c=>{for(const u of c||[])u.status==="rejected"&&o(u.reason);return r().catch(o)})},components={page:()=>__vitePreload(()=>import("./index-Comk0Mdd.js"),__vite__mapDeps([0,1,2,3])),container:()=>__vitePreload(()=>import("./Container-BpMiPnhd.js"),__vite__mapDeps([4,1,3,2])),button:()=>__vitePreload(()=>import("./index-BMAuCMjm.js"),__vite__mapDeps([5,2])),text:()=>__vitePreload(()=>import("./index-dqwW3_a1.js"),__vite__mapDeps([6,2])),img:()=>__vitePreload(()=>import("./index-9nwqbliO.js"),__vite__mapDeps([7,2])),qrcode:()=>__vitePreload(()=>import("./index-T3SVGUQk.js"),__vite__mapDeps([8,2])),overlay:()=>__vitePreload(()=>import("./index-BefqyKqa.js"),__vite__mapDeps([9,3,2])),"page-fragment-container":()=>__vitePreload(()=>import("./PageFragmentContainer-4IB1FBBb.js"),__vite__mapDeps([10,1,3,2,11])),"page-fragment":()=>__vitePreload(()=>import("./PageFragment-Ce_jqCIf.js"),__vite__mapDeps([12,3,2])),"iterator-container":()=>__vitePreload(()=>import("./IteratorContainer-BzvKmQpC.js"),__vite__mapDeps([13,3,2]))},datasources={},plugins={};var axios$2={exports:{}},bind,hasRequiredBind;function requireBind(){return hasRequiredBind||(hasRequiredBind=1,bind=function(r,n){return function(){for(var i=new Array(arguments.length),o=0;o<i.length;o++)i[o]=arguments[o];return r.apply(n,i)}}),bind}var utils,hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1;var e=requireBind(),r=Object.prototype.toString;function n(g){return Array.isArray(g)}function s(g){return typeof g>"u"}function i(g){return g!==null&&!s(g)&&g.constructor!==null&&!s(g.constructor)&&typeof g.constructor.isBuffer=="function"&&g.constructor.isBuffer(g)}function o(g){return r.call(g)==="[object ArrayBuffer]"}function c(g){return r.call(g)==="[object FormData]"}function u(g){var A;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?A=ArrayBuffer.isView(g):A=g&&g.buffer&&o(g.buffer),A}function l(g){return typeof g=="string"}function f(g){return typeof g=="number"}function d(g){return g!==null&&typeof g=="object"}function h(g){if(r.call(g)!=="[object Object]")return!1;var A=Object.getPrototypeOf(g);return A===null||A===Object.prototype}function y(g){return r.call(g)==="[object Date]"}function b(g){return r.call(g)==="[object File]"}function v(g){return r.call(g)==="[object Blob]"}function j(g){return r.call(g)==="[object Function]"}function w(g){return d(g)&&j(g.pipe)}function I(g){return r.call(g)==="[object URLSearchParams]"}function P(g){return g.trim?g.trim():g.replace(/^\s+|\s+$/g,"")}function x(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function p(g,A){if(!(g===null||typeof g>"u"))if(typeof g!="object"&&(g=[g]),n(g))for(var S=0,R=g.length;S<R;S++)A.call(null,g[S],S,g);else for(var D in g)Object.prototype.hasOwnProperty.call(g,D)&&A.call(null,g[D],D,g)}function m(){var g={};function A(D,M){h(g[M])&&h(D)?g[M]=m(g[M],D):h(D)?g[M]=m({},D):n(D)?g[M]=D.slice():g[M]=D}for(var S=0,R=arguments.length;S<R;S++)p(arguments[S],A);return g}function T(g,A,S){return p(A,function(D,M){S&&typeof D=="function"?g[M]=e(D,S):g[M]=D}),g}function _(g){return g.charCodeAt(0)===65279&&(g=g.slice(1)),g}return utils={isArray:n,isArrayBuffer:o,isBuffer:i,isFormData:c,isArrayBufferView:u,isString:l,isNumber:f,isObject:d,isPlainObject:h,isUndefined:s,isDate:y,isFile:b,isBlob:v,isFunction:j,isStream:w,isURLSearchParams:I,isStandardBrowserEnv:x,forEach:p,merge:m,extend:T,trim:P,stripBOM:_},utils}var buildURL,hasRequiredBuildURL;function requireBuildURL(){if(hasRequiredBuildURL)return buildURL;hasRequiredBuildURL=1;var e=requireUtils();function r(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}return buildURL=function(s,i,o){if(!i)return s;var c;if(o)c=o(i);else if(e.isURLSearchParams(i))c=i.toString();else{var u=[];e.forEach(i,function(d,h){d===null||typeof d>"u"||(e.isArray(d)?h=h+"[]":d=[d],e.forEach(d,function(b){e.isDate(b)?b=b.toISOString():e.isObject(b)&&(b=JSON.stringify(b)),u.push(r(h)+"="+r(b))}))}),c=u.join("&")}if(c){var l=s.indexOf("#");l!==-1&&(s=s.slice(0,l)),s+=(s.indexOf("?")===-1?"?":"&")+c}return s},buildURL}var InterceptorManager_1,hasRequiredInterceptorManager;function requireInterceptorManager(){if(hasRequiredInterceptorManager)return InterceptorManager_1;hasRequiredInterceptorManager=1;var e=requireUtils();function r(){this.handlers=[]}return r.prototype.use=function(s,i,o){return this.handlers.push({fulfilled:s,rejected:i,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(s){this.handlers[s]&&(this.handlers[s]=null)},r.prototype.forEach=function(s){e.forEach(this.handlers,function(o){o!==null&&s(o)})},InterceptorManager_1=r,InterceptorManager_1}var normalizeHeaderName,hasRequiredNormalizeHeaderName;function requireNormalizeHeaderName(){if(hasRequiredNormalizeHeaderName)return normalizeHeaderName;hasRequiredNormalizeHeaderName=1;var e=requireUtils();return normalizeHeaderName=function(n,s){e.forEach(n,function(o,c){c!==s&&c.toUpperCase()===s.toUpperCase()&&(n[s]=o,delete n[c])})},normalizeHeaderName}var enhanceError,hasRequiredEnhanceError;function requireEnhanceError(){return hasRequiredEnhanceError||(hasRequiredEnhanceError=1,enhanceError=function(r,n,s,i,o){return r.config=n,s&&(r.code=s),r.request=i,r.response=o,r.isAxiosError=!0,r.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},r}),enhanceError}var createError,hasRequiredCreateError;function requireCreateError(){if(hasRequiredCreateError)return createError;hasRequiredCreateError=1;var e=requireEnhanceError();return createError=function(n,s,i,o,c){var u=new Error(n);return e(u,s,i,o,c)},createError}var settle,hasRequiredSettle;function requireSettle(){if(hasRequiredSettle)return settle;hasRequiredSettle=1;var e=requireCreateError();return settle=function(n,s,i){var o=i.config.validateStatus;!i.status||!o||o(i.status)?n(i):s(e("Request failed with status code "+i.status,i.config,null,i.request,i))},settle}var cookies,hasRequiredCookies;function requireCookies(){if(hasRequiredCookies)return cookies;hasRequiredCookies=1;var e=requireUtils();return cookies=e.isStandardBrowserEnv()?function(){return{write:function(s,i,o,c,u,l){var f=[];f.push(s+"="+encodeURIComponent(i)),e.isNumber(o)&&f.push("expires="+new Date(o).toGMTString()),e.isString(c)&&f.push("path="+c),e.isString(u)&&f.push("domain="+u),l===!0&&f.push("secure"),document.cookie=f.join("; ")},read:function(s){var i=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),cookies}var isAbsoluteURL,hasRequiredIsAbsoluteURL;function requireIsAbsoluteURL(){return hasRequiredIsAbsoluteURL||(hasRequiredIsAbsoluteURL=1,isAbsoluteURL=function(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}),isAbsoluteURL}var combineURLs,hasRequiredCombineURLs;function requireCombineURLs(){return hasRequiredCombineURLs||(hasRequiredCombineURLs=1,combineURLs=function(r,n){return n?r.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):r}),combineURLs}var buildFullPath,hasRequiredBuildFullPath;function requireBuildFullPath(){if(hasRequiredBuildFullPath)return buildFullPath;hasRequiredBuildFullPath=1;var e=requireIsAbsoluteURL(),r=requireCombineURLs();return buildFullPath=function(s,i){return s&&!e(i)?r(s,i):i},buildFullPath}var parseHeaders,hasRequiredParseHeaders;function requireParseHeaders(){if(hasRequiredParseHeaders)return parseHeaders;hasRequiredParseHeaders=1;var e=requireUtils(),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return parseHeaders=function(s){var i={},o,c,u;return s&&e.forEach(s.split("\n"),function(f){if(u=f.indexOf(":"),o=e.trim(f.substr(0,u)).toLowerCase(),c=e.trim(f.substr(u+1)),o){if(i[o]&&r.indexOf(o)>=0)return;o==="set-cookie"?i[o]=(i[o]?i[o]:[]).concat([c]):i[o]=i[o]?i[o]+", "+c:c}}),i},parseHeaders}var isURLSameOrigin,hasRequiredIsURLSameOrigin;function requireIsURLSameOrigin(){if(hasRequiredIsURLSameOrigin)return isURLSameOrigin;hasRequiredIsURLSameOrigin=1;var e=requireUtils();return isURLSameOrigin=e.isStandardBrowserEnv()?function(){var n=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a"),i;function o(c){var u=c;return n&&(s.setAttribute("href",u),u=s.href),s.setAttribute("href",u),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return i=o(window.location.href),function(u){var l=e.isString(u)?o(u):u;return l.protocol===i.protocol&&l.host===i.host}}():function(){return function(){return!0}}(),isURLSameOrigin}var Cancel_1,hasRequiredCancel;function requireCancel(){if(hasRequiredCancel)return Cancel_1;hasRequiredCancel=1;function e(r){this.message=r}return e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,Cancel_1=e,Cancel_1}var xhr,hasRequiredXhr;function requireXhr(){if(hasRequiredXhr)return xhr;hasRequiredXhr=1;var e=requireUtils(),r=requireSettle(),n=requireCookies(),s=requireBuildURL(),i=requireBuildFullPath(),o=requireParseHeaders(),c=requireIsURLSameOrigin(),u=requireCreateError(),l=requireDefaults(),f=requireCancel();return xhr=function(h){return new Promise(function(b,v){var j=h.data,w=h.headers,I=h.responseType,P;function x(){h.cancelToken&&h.cancelToken.unsubscribe(P),h.signal&&h.signal.removeEventListener("abort",P)}e.isFormData(j)&&delete w["Content-Type"];var p=new XMLHttpRequest;if(h.auth){var m=h.auth.username||"",T=h.auth.password?unescape(encodeURIComponent(h.auth.password)):"";w.Authorization="Basic "+btoa(m+":"+T)}var _=i(h.baseURL,h.url);p.open(h.method.toUpperCase(),s(_,h.params,h.paramsSerializer),!0),p.timeout=h.timeout;function g(){if(p){var S="getAllResponseHeaders"in p?o(p.getAllResponseHeaders()):null,R=!I||I==="text"||I==="json"?p.responseText:p.response,D={data:R,status:p.status,statusText:p.statusText,headers:S,config:h,request:p};r(function(H){b(H),x()},function(H){v(H),x()},D),p=null}}if("onloadend"in p?p.onloadend=g:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(g)},p.onabort=function(){p&&(v(u("Request aborted",h,"ECONNABORTED",p)),p=null)},p.onerror=function(){v(u("Network Error",h,null,p)),p=null},p.ontimeout=function(){var R=h.timeout?"timeout of "+h.timeout+"ms exceeded":"timeout exceeded",D=h.transitional||l.transitional;h.timeoutErrorMessage&&(R=h.timeoutErrorMessage),v(u(R,h,D.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},e.isStandardBrowserEnv()){var A=(h.withCredentials||c(_))&&h.xsrfCookieName?n.read(h.xsrfCookieName):void 0;A&&(w[h.xsrfHeaderName]=A)}"setRequestHeader"in p&&e.forEach(w,function(R,D){typeof j>"u"&&D.toLowerCase()==="content-type"?delete w[D]:p.setRequestHeader(D,R)}),e.isUndefined(h.withCredentials)||(p.withCredentials=!!h.withCredentials),I&&I!=="json"&&(p.responseType=h.responseType),typeof h.onDownloadProgress=="function"&&p.addEventListener("progress",h.onDownloadProgress),typeof h.onUploadProgress=="function"&&p.upload&&p.upload.addEventListener("progress",h.onUploadProgress),(h.cancelToken||h.signal)&&(P=function(S){p&&(v(!S||S&&S.type?new f("canceled"):S),p.abort(),p=null)},h.cancelToken&&h.cancelToken.subscribe(P),h.signal&&(h.signal.aborted?P():h.signal.addEventListener("abort",P))),j||(j=null),p.send(j)})},xhr}var defaults_1,hasRequiredDefaults;function requireDefaults(){if(hasRequiredDefaults)return defaults_1;hasRequiredDefaults=1;var e=requireUtils(),r=requireNormalizeHeaderName(),n=requireEnhanceError(),s={"Content-Type":"application/x-www-form-urlencoded"};function i(l,f){!e.isUndefined(l)&&e.isUndefined(l["Content-Type"])&&(l["Content-Type"]=f)}function o(){var l;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(l=requireXhr()),l}function c(l,f,d){if(e.isString(l))try{return(f||JSON.parse)(l),e.trim(l)}catch(h){if(h.name!=="SyntaxError")throw h}return(0,JSON.stringify)(l)}var u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:o(),transformRequest:[function(f,d){return r(d,"Accept"),r(d,"Content-Type"),e.isFormData(f)||e.isArrayBuffer(f)||e.isBuffer(f)||e.isStream(f)||e.isFile(f)||e.isBlob(f)?f:e.isArrayBufferView(f)?f.buffer:e.isURLSearchParams(f)?(i(d,"application/x-www-form-urlencoded;charset=utf-8"),f.toString()):e.isObject(f)||d&&d["Content-Type"]==="application/json"?(i(d,"application/json"),c(f)):f}],transformResponse:[function(f){var d=this.transitional||u.transitional,h=d&&d.silentJSONParsing,y=d&&d.forcedJSONParsing,b=!h&&this.responseType==="json";if(b||y&&e.isString(f)&&f.length)try{return JSON.parse(f)}catch(v){if(b)throw v.name==="SyntaxError"?n(v,this,"E_JSON_PARSE"):v}return f}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(f){return f>=200&&f<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};return e.forEach(["delete","get","head"],function(f){u.headers[f]={}}),e.forEach(["post","put","patch"],function(f){u.headers[f]=e.merge(s)}),defaults_1=u,defaults_1}var transformData,hasRequiredTransformData;function requireTransformData(){if(hasRequiredTransformData)return transformData;hasRequiredTransformData=1;var e=requireUtils(),r=requireDefaults();return transformData=function(s,i,o){var c=this||r;return e.forEach(o,function(l){s=l.call(c,s,i)}),s},transformData}var isCancel,hasRequiredIsCancel;function requireIsCancel(){return hasRequiredIsCancel||(hasRequiredIsCancel=1,isCancel=function(r){return!!(r&&r.__CANCEL__)}),isCancel}var dispatchRequest,hasRequiredDispatchRequest;function requireDispatchRequest(){if(hasRequiredDispatchRequest)return dispatchRequest;hasRequiredDispatchRequest=1;var e=requireUtils(),r=requireTransformData(),n=requireIsCancel(),s=requireDefaults(),i=requireCancel();function o(c){if(c.cancelToken&&c.cancelToken.throwIfRequested(),c.signal&&c.signal.aborted)throw new i("canceled")}return dispatchRequest=function(u){o(u),u.headers=u.headers||{},u.data=r.call(u,u.data,u.headers,u.transformRequest),u.headers=e.merge(u.headers.common||{},u.headers[u.method]||{},u.headers),e.forEach(["delete","get","head","post","put","patch","common"],function(d){delete u.headers[d]});var l=u.adapter||s.adapter;return l(u).then(function(d){return o(u),d.data=r.call(u,d.data,d.headers,u.transformResponse),d},function(d){return n(d)||(o(u),d&&d.response&&(d.response.data=r.call(u,d.response.data,d.response.headers,u.transformResponse))),Promise.reject(d)})},dispatchRequest}var mergeConfig,hasRequiredMergeConfig;function requireMergeConfig(){if(hasRequiredMergeConfig)return mergeConfig;hasRequiredMergeConfig=1;var e=requireUtils();return mergeConfig=function(n,s){s=s||{};var i={};function o(h,y){return e.isPlainObject(h)&&e.isPlainObject(y)?e.merge(h,y):e.isPlainObject(y)?e.merge({},y):e.isArray(y)?y.slice():y}function c(h){if(e.isUndefined(s[h])){if(!e.isUndefined(n[h]))return o(void 0,n[h])}else return o(n[h],s[h])}function u(h){if(!e.isUndefined(s[h]))return o(void 0,s[h])}function l(h){if(e.isUndefined(s[h])){if(!e.isUndefined(n[h]))return o(void 0,n[h])}else return o(void 0,s[h])}function f(h){if(h in s)return o(n[h],s[h]);if(h in n)return o(void 0,n[h])}var d={url:u,method:u,data:u,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:f};return e.forEach(Object.keys(n).concat(Object.keys(s)),function(y){var b=d[y]||c,v=b(y);e.isUndefined(v)&&b!==f||(i[y]=v)}),i},mergeConfig}var data,hasRequiredData;function requireData(){return hasRequiredData||(hasRequiredData=1,data={version:"0.25.0"}),data}var validator,hasRequiredValidator;function requireValidator(){if(hasRequiredValidator)return validator;hasRequiredValidator=1;var e=requireData().version,r={};["object","boolean","number","function","string","symbol"].forEach(function(i,o){r[i]=function(u){return typeof u===i||"a"+(o<1?"n ":" ")+i}});var n={};r.transitional=function(o,c,u){function l(f,d){return"[Axios v"+e+"] Transitional option '"+f+"'"+d+(u?". "+u:"")}return function(f,d,h){if(o===!1)throw new Error(l(d," has been removed"+(c?" in "+c:"")));return c&&!n[d]&&(n[d]=!0,console.warn(l(d," has been deprecated since v"+c+" and will be removed in the near future"))),o?o(f,d,h):!0}};function s(i,o,c){if(typeof i!="object")throw new TypeError("options must be an object");for(var u=Object.keys(i),l=u.length;l-- >0;){var f=u[l],d=o[f];if(d){var h=i[f],y=h===void 0||d(h,f,i);if(y!==!0)throw new TypeError("option "+f+" must be "+y);continue}if(c!==!0)throw Error("Unknown option "+f)}}return validator={assertOptions:s,validators:r},validator}var Axios_1,hasRequiredAxios$2;function requireAxios$2(){if(hasRequiredAxios$2)return Axios_1;hasRequiredAxios$2=1;var e=requireUtils(),r=requireBuildURL(),n=requireInterceptorManager(),s=requireDispatchRequest(),i=requireMergeConfig(),o=requireValidator(),c=o.validators;function u(l){this.defaults=l,this.interceptors={request:new n,response:new n}}return u.prototype.request=function(f,d){if(typeof f=="string"?(d=d||{},d.url=f):d=f||{},!d.url)throw new Error("Provided config url is not valid");d=i(this.defaults,d),d.method?d.method=d.method.toLowerCase():this.defaults.method?d.method=this.defaults.method.toLowerCase():d.method="get";var h=d.transitional;h!==void 0&&o.assertOptions(h,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var y=[],b=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(d)===!1||(b=b&&m.synchronous,y.unshift(m.fulfilled,m.rejected))});var v=[];this.interceptors.response.forEach(function(m){v.push(m.fulfilled,m.rejected)});var j;if(!b){var w=[s,void 0];for(Array.prototype.unshift.apply(w,y),w=w.concat(v),j=Promise.resolve(d);w.length;)j=j.then(w.shift(),w.shift());return j}for(var I=d;y.length;){var P=y.shift(),x=y.shift();try{I=P(I)}catch(p){x(p);break}}try{j=s(I)}catch(p){return Promise.reject(p)}for(;v.length;)j=j.then(v.shift(),v.shift());return j},u.prototype.getUri=function(f){if(!f.url)throw new Error("Provided config url is not valid");return f=i(this.defaults,f),r(f.url,f.params,f.paramsSerializer).replace(/^\?/,"")},e.forEach(["delete","get","head","options"],function(f){u.prototype[f]=function(d,h){return this.request(i(h||{},{method:f,url:d,data:(h||{}).data}))}}),e.forEach(["post","put","patch"],function(f){u.prototype[f]=function(d,h,y){return this.request(i(y||{},{method:f,url:d,data:h}))}}),Axios_1=u,Axios_1}var CancelToken_1,hasRequiredCancelToken;function requireCancelToken(){if(hasRequiredCancelToken)return CancelToken_1;hasRequiredCancelToken=1;var e=requireCancel();function r(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var s;this.promise=new Promise(function(c){s=c});var i=this;this.promise.then(function(o){if(i._listeners){var c,u=i._listeners.length;for(c=0;c<u;c++)i._listeners[c](o);i._listeners=null}}),this.promise.then=function(o){var c,u=new Promise(function(l){i.subscribe(l),c=l}).then(o);return u.cancel=function(){i.unsubscribe(c)},u},n(function(c){i.reason||(i.reason=new e(c),s(i.reason))})}return r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.prototype.subscribe=function(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]},r.prototype.unsubscribe=function(s){if(this._listeners){var i=this._listeners.indexOf(s);i!==-1&&this._listeners.splice(i,1)}},r.source=function(){var s,i=new r(function(c){s=c});return{token:i,cancel:s}},CancelToken_1=r,CancelToken_1}var spread,hasRequiredSpread;function requireSpread(){return hasRequiredSpread||(hasRequiredSpread=1,spread=function(r){return function(s){return r.apply(null,s)}}),spread}var isAxiosError,hasRequiredIsAxiosError;function requireIsAxiosError(){if(hasRequiredIsAxiosError)return isAxiosError;hasRequiredIsAxiosError=1;var e=requireUtils();return isAxiosError=function(n){return e.isObject(n)&&n.isAxiosError===!0},isAxiosError}var hasRequiredAxios$1;function requireAxios$1(){if(hasRequiredAxios$1)return axios$2.exports;hasRequiredAxios$1=1;var e=requireUtils(),r=requireBind(),n=requireAxios$2(),s=requireMergeConfig(),i=requireDefaults();function o(u){var l=new n(u),f=r(n.prototype.request,l);return e.extend(f,n.prototype,l),e.extend(f,l),f.create=function(h){return o(s(u,h))},f}var c=o(i);return c.Axios=n,c.Cancel=requireCancel(),c.CancelToken=requireCancelToken(),c.isCancel=requireIsCancel(),c.VERSION=requireData().version,c.all=function(l){return Promise.all(l)},c.spread=requireSpread(),c.isAxiosError=requireIsAxiosError(),axios$2.exports=c,axios$2.exports.default=c,axios$2.exports}var axios$1,hasRequiredAxios;function requireAxios(){return hasRequiredAxios||(hasRequiredAxios=1,axios$1=requireAxios$1()),axios$1}var axiosExports=requireAxios();const axios=getDefaultExportFromCjs(axiosExports),requestHandler=function(e){return e},responseHandler=function(e){return e},service=axios.create({withCredentials:!0,timeout:7e3});service.interceptors.request.use(requestHandler);service.interceptors.response.use(responseHandler);const request={install(e){e.provide("request",service)}},useDsl=e=>{var s,i;const r=VueDemi.ref(((s=e==null?void 0:e.page)==null?void 0:s.data)||{}),n=(o,c,u)=>{o.forEach(l=>{isPage(l)?r.value=l:replaceChildNode(VueDemi.reactive(l),[r.value])}),e&&VueDemi.nextTick(()=>{e.emit("replaced-node",{nodes:o,sourceId:c,...u})})};return(i=e==null?void 0:e.dataSourceManager)==null||i.on("update-data",n),VueDemi.onBeforeUnmount(()=>{var o;(o=e==null?void 0:e.dataSourceManager)==null||o.off("update-data",n)}),{pageConfig:r}};function useComponent(e=""){let r,n,s;return typeof e=="string"?r=e:{componentType:r,app:n}=e,(!r||r==="")&&(r="container"),n||(n=VueDemi.inject("app")),s=resolveComponent({componentType:r,app:n}),!s&&!r.startsWith("magic-ui-")&&(r="magic-ui-".concat(toLine(r)),s=resolveComponent({componentType:r,app:n})),s!=null?s:r}function resolveComponent({componentType:e,app:r}){return r==null?void 0:r.resolveComponent(e)}const _sfc_main=Vue.defineComponent({__name:"App",setup(e){const r=Vue.inject("app"),{pageConfig:n}=useDsl(r),s=useComponent("page");return r==null||r.on("page-change",i=>{if(!i)throw new Error("");addParamToUrl({page:i.data.id},window)}),(i,o)=>(Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(Vue.unref(s)),{config:Vue.unref(n)},null,8,["config"]))}}),getLocalConfig=()=>{const configStr=localStorage.getItem("magicDSL");if(!configStr)return[];try{return[eval("(".concat(configStr,")"))]}catch(e){return[]}};DataSourceManager.registerObservedData(DeepObservedData);const vueApp=Vue.createApp(_sfc_main);vueApp.use(request);const dsl=((getUrlParam("localPreview")?getLocalConfig():window.magicDSL)||[])[0]||{},app=new App({ua:window.navigator.userAgent,config:dsl,request:service,curPage:getUrlParam("page"),useMock:!!getUrlParam("useMock")});app.setDesignWidth(app.env.isWeb?window.document.documentElement.getBoundingClientRect().width:375);Object.entries(components).forEach(([e,r])=>{app.registerComponent(e,Vue.defineAsyncComponent(r))});Object.values(plugins).forEach(e=>{vueApp.use(e,{app})});registerDataSourceOnDemand(dsl,datasources).then(e=>{Object.entries(e).forEach(([r,n])=>{DataSourceManager.register(r,n)}),vueApp.config.globalProperties.app=app,vueApp.provide("app",app),vueApp.mount("#app")});export{EventEmitter$1 as E,__vite_legacy_guard,cloneDeep$1 as c,eventsExports as e,getDefaultExportFromCjs as g,isDslNode as i,set as s,toLine as t};
//# sourceMappingURL=index-BZ8ZNF0v.js.map
